[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS626-yiqiong-pan",
    "section": "",
    "text": "Welcome to ISSS626 Geospatial Analytics and Applications. In this website, you will find my coursework prepared for this course."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "The following code chunk uses the p_load() function from the pacman package to check whether the sf and tidyverse packages are installed. If they are, it loads them into the R session; if not, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tidyverse)\n\n\n\n\nThe geospatial datasets include shapefiles and KML file. (The reason of selecting file format). The geospatial data consist of the Master Plan 2014 Subzone Boundary (Web), Pre-Schools Location from data.gov.sg, and Cycling Path from LTA DataMall. The aspatial dataset is the Singapore Airbnb listings from Inside Airbnb.\nR itself is case-sensitive, especially for object and function names. Whether file paths are case-sensitive depends on the operating system, e.g. On Windows: it is not case-sensitive.\n\n1.4.1 The code below uses the st_read() function from the sf package to load the Master Plan 2014 Subzone Boundary (Web) shapefile as a polygon data frame. For shapefiles, the .shp extension does not need to be specified in the code. Both absolute and relative paths can be used, but a relative path is applied here to keep the code cleaner and shorter.\n\n\nmpsz = st_read(dsn = \"data/geospatial\",\n               layer = \"mp14_SUBZONE_WEB_PL\")\n\nReading layer `mp14_SUBZONE_WEB_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n1.4.2 Similarly, the code below uses st_read() to import the Pre-Schools Location shapefile as a polyline data frame.\n\n\ncyclingpath = st_read(dsn = \"data/geospatial\",\n                      layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4651 features and 19 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\n\n1.4.3 The code below uses st_read() to import the Pre-Schools Location in KML format as point feature data frame into R. When importing a KML file, the .kml extension must be included.\n\nsvy21 vs wgs84?\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\n\n\nBoth two code chunks display the basic information about the dataset. However, it is more common to use the second approach.\n\nmpsz$geom\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\nst_geometry(mpsz)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nAlthough it is mentioned as one of the ways to retrieve the first 5 records like the two code chunks above, but here we see seems to be ID column?\n\nmpsz[[1]]\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108\n[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126\n[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144\n[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162\n[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180\n[181] 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198\n[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216\n[217] 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234\n[235] 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252\n[253] 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270\n[271] 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288\n[289] 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306\n[307] 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323\n\n\nFurthermore, the code below uses glimpse() of dplyr to display more detailed attribute information in the data frame.\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nLastly, the code below uses the head() function from base R (similar to Python, where the argument n can be set manually) to display the first few rows of the data frame for a quick overview.\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n\n\n\n\n\nVisualising an sf data frame is straightforward: using the plot() of Base R function automatically generates small coloured maps of the geometries by each attribute (field), while excluding non-informative columns such as the OBJECTID.\n\nplot(mpsz)\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\nMeanwhile, the code chunk below can be used to display the silhouette of the map:\n\nplot(st_geometry(mpsz))\n\n\n\n\n\n\n\n\nWe can also focus on a specific attribute by using the code chunk below:\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\n\n\nTo get a polished view of the data, we can use the tmap package, but it takes longer processing time:\n\n#library(tmap)\n#tm_shape(mpsz) +\n  #tm_fill(\"PLN_AREA_N\")+\n  #tm_borders()\n\n## comment out to save time\n\nBelow we quickly plot the preschool and cyclingpath.\n\nplot(st_geometry(preschool))\n\n\n\n\n\n\n\nplot(st_geometry(cyclingpath))\n\n\n\n\n\n\n\n\nBelow we can plot the cyclingpath layer on the top of the mpsz layer by using add argument.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(cyclingpath),\n     add = TRUE, col = \"Blue\")\n\n\n\n\n\n\n\n\nWhen trying the code with preschool, the preschool points does not appear on the subzone map because the two layers use different CRSs (mpsz in SVY21 and preschool in WGS84), transformation of preschool into the same CRS as mpsz is required before plotting the aligned map.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool),\n     add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nst_crs(preschool)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\nst_crs(cyclingpath)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nThe above funtion st_crs() reveals that the layers of mpsz and cyclingpath are indeed in SVY21, but they are missing the correct EPSG code (3414). Assigning EPSG 3414 by using st_set_crs() of sf packages ensures the CRS is properly identified, as below:\n\nmpsz &lt;- st_set_crs(mpsz,3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nOn the other hand, the code below using st_transform() reprojects the preschool data from the WGS84 to SVY21.\n\npreschool &lt;- st_transform(preschool,\n                          crs = 3414)\n\nBy display the preview of preschool sf data, we can confirm its CRS is SVY21 now.\n\nst_geometry(preschool)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)\n\n\nHere we could align both data together by setting add argument TRUE.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool), add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n1.8.1 The chunk below first uses read_csv() from readr to import listing.csv into R as a tibble data frame, and then applies list() from base R to preview the first 10 records, similar to glimpse() of dplyr.\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\n\nRows: 3659 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nlist(listings)\n\n[[1]]\n# A tibble: 3,659 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Ensuite …  367042 Belinda   East Region         Tampines          1.35\n 2  71896 B&B  Roo…  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Room 2-n…  367042 Belinda   East Region         Tampines          1.35\n 4 275343 10min wa… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 15 mins … 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 294281 5 mins w… 1521514 Elizabeth Central Region      Newton            1.31\n 7 324945 Comforta… 1439258 Kay       Central Region      Bukit Merah       1.29\n 8 330095 Relaxing… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 344803 Budget s…  367042 Belinda   East Region         Tampines          1.35\n10 369141 5mins fr… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,649 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n1.8.2 The code chunk below uses st_as_sf() of sf package to convert the listings data frame into a simple feature data frame. Specifically the coordinates are first defined in WGS84 (EPSG:4326, longitude/latitude in degrees) and then reprojected into Singapore’s SVY21 system (EPSG:3414, X/Y in metres).\n\nlistings_sf &lt;- st_as_sf(listings,\n                        coords = c(\"longitude\", \"latitude\"),\n                        crs = 4326) %&gt;% #used to nest st_transform() \n  st_transform(crs = 3414)\n\n\nglimpse(listings_sf)\n\nRows: 3,659\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 29…\n$ name                           &lt;chr&gt; \"Ensuite Room (Room 1 & 2) near EXPO\", …\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 143, NA, 76, NA, NA, 85, NA, NA, 41, 79…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 180, 180, 92, 180, 180, 92,…\n$ number_of_reviews              &lt;dbl&gt; 19, 24, 46, 20, 16, 131, 17, 5, 60, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0.10, 0.80, 0.1…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 58, 5, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 90, 79, 90, 153, 153, 365, 153, 153, 36…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, \"S039…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…\n\n\nDIY: the code chuck below plots listings_sf onto mpsz layer. The map looks better when ploting mpsz first and then listings_sf, because the polygons give context (the “base map”), and the points can be layered on top without being hidden. Thus better order is polygons first, points later.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(listings_sf), add = TRUE)\n\n\n\n\n\n\n\n\n\n#plot(st_geometry(listings_sf))\n#plot(st_geometry(mpsz), add = TRUE)\n\n\n\n\n\n\nTask: compute the total land area to reserve for a 5-m corridor/shoulder on both sides of the cycling paths.\n&lt;- assignment (always use this for storing values/importing data).\n= function arguments (inside function calls).\nSolution:\nStep 1: st_buffer() of sf package: 5-metre buffers of reserved land on both sides of existing cycling path.\n\n# quick review of the geometry type\nst_geometry_type(cyclingpath, by_geometry = FALSE)\n\n[1] MULTILINESTRING\n18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE\n\n\n\n# quick overview of the cycling path data\nglimpse(cyclingpath)\n\nRows: 4,651\nColumns: 20\n$ PATH_TYPE  &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ LVL_NUM    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ AGENCY_IMP &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ AGENCY_MAI &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ GAZETTE_DA &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ LAUNCH_DAT &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ MISC       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PKG_REF    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ AGENCY_M_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ AGENCY_I_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ LVL_NUM_DE &lt;chr&gt; \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\",…\n$ PATH_TYPE_ &lt;chr&gt; \"Shared Path\", \"Shared Path\", \"Shared Path\", \"Shared Path\",…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\n\nbuffer_cycling &lt;- st_buffer(\n  cyclingpath, dist=5, nQuadSegs = 30)\n\n#st_buffer()builds polygons at a fixed offset from a geometry.\n#cyclingpath is input, multilinestrings layer\n#dist=5, buffer distance in the layer's units. \n#Here CRS is SVY221 in metre, thus no transformation is required.\n#nQuadSegs = 30, higher the value, smoother the curve in the buffer around corners or ends.\n#stands for “number of line segments to use to approximate a quarter circle\".\n\nStep 2: use st_area() to calculate each area of the buffers\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n#st_area() returns area of each feature in the geometry column\n# units vector (m^2)\n#buffer_cycling$AREA adds a new attribute column AREA\n\nAlternatively, code uses tidyverse\n\nbuffer_cycling &lt;- buffer_cycling %&gt;%\n  mutate(AREA = st_area(geometry))\n# mutate() of dplyr, just like the $AREA, creates a new column AREA\n#geometry is the sf geometry column; st_area(geometry) computes area for each row.\n\nStep 3: sum() of Base R to add up all AREA values.\nWhat if the areas are overlapped?\n\nsum(buffer_cycling$AREA)\n\n3561648 [m^2]\n\n\nStep 4: plotting the buffer by a selected planning subzone: Tampines West\n\nfilter() of dplyr package to select the subzone\n\n\n#quick overview of the mpsz\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\nmpsz_selected &lt;- mpsz %&gt;%\n  filter(SUBZONE_N == \"TAMPINES WEST\")\n#quick overview of the newly selected subzone\nst_geometry(mpsz_selected)\n\nGeometry set for 1 feature \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 38199.84 ymin: 35355.22 xmax: 40642.12 ymax: 38054.52\nProjected CRS: SVY21 / Singapore TM\n\n\nMULTIPOLYGON (((39918.43 35362.32, 39909.84 353...\n\n#creating a plot for the subzone in general\nplot(st_geometry(mpsz_selected))\n\n\n\n\n\n\n\n\n\nst_intersection() of sf package to clip clycing buffers within the subzone. Both layers are in the SVY21. However, since EPSG code is missing in buffer_cycling, we need to assign the code 3414 to it before performing intersection.\n\n\n# checking features of the two layers\nst_crs(buffer_cycling)$epsg\n\n[1] NA\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\nst_crs(mpsz_selected)$epsg\n\n[1] 3414\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\n# EPSG assignment, or use 3414 as second parameter\nbuffer_cycling &lt;- st_set_crs(buffer_cycling, st_crs(mpsz_selected))\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\n\n\nbuffer_cycling_selected &lt;- st_intersection(\n  buffer_cycling, mpsz_selected)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n#st_intersection(x, y) returns a new sf object = overlapping parts of x and y\n\n\nplot() to create the plot\n\n\nplot(st_geometry(buffer_cycling_selected))\n\n\n\n\n\n\n\n\nDONE!\n\n\n\nSolution:\nStep 1: Use st_intersects() from the sf package to identify pre-schools located inside each subzone. Then, use the length() function from base R to calculate the number of pre-school points within each subzone. The function st_intersects() returns a list of intersections. While length() returns only the total number of subzones, the lengths() function works on a list and returns a vector with the length of each element.\n\n#perform an overview of both data frames first\nglimpse(preschool)\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [m]&gt; POINT Z (25089.46 31299.16 0), POINT Z (27189.07 327…\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n#show the outputs individually\nst_intersects(mpsz, preschool)\n\nSparse geometry binary predicate list of length 323, where the\npredicate was `intersects'\nfirst 10 elements:\n 1: (empty)\n 2: 764, 1258, 1503, 1562, 1670, 2035\n 3: (empty)\n 4: 151, 748, 1140, 1844, 2209\n 5: 190, 1496, 1924\n 6: 237, 238, 260, 264, 283, 292, 391, 714, 949, 1494, ...\n 7: 766, 1088, 1254, 1867, 2021\n 8: 498\n 9: 363, 399, 642, 1696, 1734, 1757, 1915, 1941, 2142, 2232, ...\n 10: 1470\n\nlength(st_intersects(mpsz, preschool))\n\n[1] 323\n\nlengths(st_intersects(mpsz, preschool))\n\n  [1]  0  6  0  5  3 13  5  1 11  1  4  2  0  1  6  0  0  0  0  4  0  1  0  5  4\n [26]  1  7  2 12  7  0  0  4  0  4 10  1  3  0  6  0  3  1  0  3  0  4  1  9  0\n [51]  1  4  1  2  4  0  2  1  2  0  3  0  2  6  1  0 13  3 14  1  4  9  1  5  0\n [76]  0  3 11  0  0  1  0  3  1  2  0  0  5  0  7  3  4  0  0  7  0  0  2  0  4\n[101] 10  0 14  0  3  2  2 29 18 21  0  0  5  5  0 10 23 22  7  2  1  0  0  0  6\n[126]  6  3  0  0  8  5  5  8  6  5  5 11  9  8  0  3  8  1  0  3 24  0  7 18 11\n[151] 10 28 13  4  0  6  6  0  2  8  6  0 40  4 21  0 36 14  4 16 11 13  5  7  9\n[176] 12 30  0  0 11 13 38 11  0  8 19  5  5 72  9  0  4 32  7  3  3  9  3 38 18\n[201]  0 15  0 12  4 11 23 16  0  7 21 19  8 20 15 26  6 23 13  6  0 13  5 12 10\n[226]  7  6  7  1  8 25  3  8  0  0 18 13 10 16  9  9 17  5  1  3 22  4 12  4  9\n[251]  3  0 17 10  4  0  0  9 16 27  0 16 22 16  0 13 23  0  2  0  0 33 20  0 22\n[276]  6  8  5  6  0  0 14 21 20  1  0 22  2  0 54 27  1 10  0  0 10  0  0  0 12\n[301]  0  0  1  0 20 19  9 12  2 15  0  0  0  1  0  0  3  0  0  4  1  0  0\n\n#combine the two steps into one-line code\nmpsz$`PreSch Count` &lt;- lengths(st_intersects(mpsz, preschool))\n\n#alternatively, using tidyverse way\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Count`= lengths(st_intersects(mpsz,preschool)))\n\nNote: st_intersects() is a spatial predicate that quickly checks relationships between features and returns indices (or a list) showing which features intersect, without creating new geometries. In contrast, st_intersection() performs a full geometric overlay, generating new sf features that represent the actual overlapping geometries and carrying attributes from both input layers, which is more computationally intensive.\n\n# statistical summary for the new column\nsummary(mpsz$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n#top_n() of dplyr package to see the sub zone with the most number of pre-school\ntop_n(mpsz, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\nStep 2: The code chunk below uses st_area() from the sf package to calculate the area of each subzone, returning values in square metres because the CRS (SVY21) is in metres. Note that the SHAPE_Area field shown in the glimpse(mpsz) output is a precomputed attribute from the original dataset and may not be accurate for current analysis; we rely on st_area() instead.\n\nmpsz$AREA &lt;- mpsz %&gt;%\n  st_area()\n\nsummary(mpsz$AREA)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   39438   628261  1229894  2420882  2106483 69748299 \n\n\nThe code chunk below computes preschool density per km2 ( 1km2 = 1,000,000m2). We convert to per km2 to make the numbers comparable and readable.\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/AREA * 1000000)\n\n#quick overview of the stats for the new column\nsummary(mpsz$`PreSch Density`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nStep 3: EDA using ggplot2\n\nUse hist() of R Graphics to plot a histogram of the distribution of PreSch Density.\n\n\nhist(mpsz$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nuse ggplot2 functions to provide informative visualisation.\n\nb1. create a histogram\n\n#initiates the ggplot using mpsz data fram, set x-axis\nggplot(data=mpsz,\n       aes(x = as.numeric(`PreSch Density`))) +\n  #adds a histogram layer, with bin numbers, colour and fill colour\n  geom_histogram(bins = 20,\n                 color = \"black\",\n                 fill = \"lightblue\") + \n  #adds labels such as title, subtitle, and for x, y axis\n  labs(title = \"Are pre-school evenly distrubted in Singapore?\",\n      subtitle = \"There are many planning subzones with a single pre-school, on the other hand,\\nthere are seven planning subzones with at least 30 or more pre-schools.\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\n\n\n\nb2. create a scatterplot for PreSch Density and PreSch Count.\n\n#starts a ggplot with mpsz, and maps x to PreSch Density and y to PreSch Count.\n#Uses as.numeric() to drop units from PreSch Density and coerce it to plain numbers\nggplot(data=mpsz,\n       aes(y = `PreSch Count`,\n           x = as.numeric(`PreSch Density`))) +\n  #adds points and colours\n  geom_point(shape =21,\n             color =\"black\",\n             fill = \"lightblue\") +\n  #sets the range of data from 0 to 40.\n  xlim(0,40) +\n  ylim(0,40) + \n  #adds labels\n  labs(title =\"\",\n       x = \"Pre-school density (per km sq)\",\n       y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nThe End."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html",
    "href": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html",
    "title": "Hands-on Exercise 02",
    "section": "",
    "text": "Thematic mapping: using map symbols to visualise geographic features.\nGeovisualisation: the combination of cartography, computer science, and visualisation to enhance spatial understanding and support knowledge discovery.\n\n\nPackages used:\ntmap: for plotting choropleth maps\nreadr: for importing CSV files (tidyverse)\ntidyr: for tidying data (tidyverse)\ndplyr: for wrangling data (tidyverse)\nsf: for processing geospatial vector data\nrvest: for scraping data from web pages\nHere we load the required packages into R environment.if they are not installed, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tmap,tidyverse,rvest)\n\n\n\n\nGeospatial data is Master Plan 2019 Subzone Boundary (No Sea) (KML) downloaded from data.gov.sg.\nAspatial data is Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2024 in csv format from DOS.\n\n\nThe code chunk below use st_read() function from sf package to import Geospatial data: Master Plan 2019 Subzone Boundary (No Sea) (KML).\n\nmpsz &lt;- st_read(\"data/geospatial/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\nReading layer `URA_MP19_SUBZONE_NO_SEA_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex02\\data\\geospatial\\MasterPlan2019SubzoneBoundaryNoSeaKML.kml' \n  using driver `KML'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n2.3.2.1 Tidying Data\n\n#quick overview of the subzone data\nst_geometry(mpsz)\n\nGeometry set for 332 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((103.8145 1.282387, 103.8177 1.2...\n\n\nMULTIPOLYGON (((103.8221 1.280494, 103.8221 1.2...\n\n\nMULTIPOLYGON (((103.8438 1.285079, 103.844 1.28...\n\n\nMULTIPOLYGON (((103.8496 1.284119, 103.8496 1.2...\n\n\nMULTIPOLYGON (((103.8525 1.286166, 103.8525 1.2...\n\nglimpse(mpsz)\n\nRows: 332\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((103.8145 1...., MULTIPOLYGON …\n\nmpsz$Description[1:10] \n\n [1] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;DEPOT ROAD&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;C22DED671DE2A940&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"        \n [2] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;2&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ02&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;085EF219A5A1AEAD&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"        \n [3] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;3&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;CHINATOWN&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;OTSZ03&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;OUTRAM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;OT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;EF2B9A91AF49E025&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"               \n [4] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;PHILLIP&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ04&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;615D4EDDEF809F8E&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"          \n [5] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;5&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;RAFFLES PLACE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ05&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;72107B11807074F4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"    \n [6] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;CHINA SQUARE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;OTSZ04&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;OUTRAM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;OT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;B609DF5587626C8F&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"            \n [7] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;10&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;TIONG BAHRU&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ10&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;A0FB4B68155D164A&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"       \n [8] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;BAYFRONT SUBZONE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;197F5E664DA4D5E1&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"\n [9] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;TIONG BAHRU STATION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ04&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;91FFE927ABE3E4DB&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"\n[10] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;6&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;CLIFFORD PIER&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ06&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;945CC212CA80626F&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"    \n\n#first 10: each has a small table of key–value rows like SUBZONE_N:DEPOT ROAD, REGION_N:CENTRAL REGION, etc.\n\nThe code chunk below create function extract_kml_field to extract values from the HTML description.\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  # return NA if missing or empty\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)          #parse the HTML string \n  rows &lt;- page %&gt;% html_elements(\"tr\")  #get all table rows &lt;tr&gt;\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;% #keep row where &lt;th&gt; table header text = field_name\n    html_element(\"td\") %&gt;%                                       #take its &lt;td&gt; table data\n    html_text2()                                                 #extract clean text\n  \n  if (length(value) == 0) NA_character_ else value        #return NA if no match, otherwise the value\n}\n\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n     #for each description string, call the function, It returns a length-1 character per row (or NA)\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;% #drop the raw KML attributes\n  relocate(geometry, .after = last_col()) #move the geometry column to the end\n\nInterestingly, Quarto prints the object using sf’s print method. That shows a summary and then only the first 10 rows by default.\n\nmpsz\n\nSimple feature collection with 332 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 10 features:\n         REGION_N    PLN_AREA_N           SUBZONE_N SUBZONE_C\n1  CENTRAL REGION   BUKIT MERAH          DEPOT ROAD    BMSZ12\n2  CENTRAL REGION   BUKIT MERAH         BUKIT MERAH    BMSZ02\n3  CENTRAL REGION        OUTRAM           CHINATOWN    OTSZ03\n4  CENTRAL REGION DOWNTOWN CORE             PHILLIP    DTSZ04\n5  CENTRAL REGION DOWNTOWN CORE       RAFFLES PLACE    DTSZ05\n6  CENTRAL REGION        OUTRAM        CHINA SQUARE    OTSZ04\n7  CENTRAL REGION   BUKIT MERAH         TIONG BAHRU    BMSZ10\n8  CENTRAL REGION DOWNTOWN CORE    BAYFRONT SUBZONE    DTSZ12\n9  CENTRAL REGION   BUKIT MERAH TIONG BAHRU STATION    BMSZ04\n10 CENTRAL REGION DOWNTOWN CORE       CLIFFORD PIER    DTSZ06\n                         geometry\n1  MULTIPOLYGON (((103.8145 1....\n2  MULTIPOLYGON (((103.8221 1....\n3  MULTIPOLYGON (((103.8438 1....\n4  MULTIPOLYGON (((103.8496 1....\n5  MULTIPOLYGON (((103.8525 1....\n6  MULTIPOLYGON (((103.8486 1....\n7  MULTIPOLYGON (((103.8311 1....\n8  MULTIPOLYGON (((103.8589 1....\n9  MULTIPOLYGON (((103.8283 1....\n10 MULTIPOLYGON (((103.8552 1....\n\n\n\n\n\nwe use read_csv() to import the csv file as a tibble dataframe and name it popdata.\n\npopdata &lt;- read_csv(\"data/aspatial/respopagesextod2024.csv\")\n\nRows: 100928 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(popdata, 5)\n\n# A tibble: 5 × 7\n  PA         SZ                     AG     Sex   TOD                   Pop  Time\n  &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;\n1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 1- and 2-Room …     0  2024\n2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 3-Room Flats        0  2024\n3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 4-Room Flats       10  2024\n4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 5-Room and Exe…    20  2024\n5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HUDC Flats (exclud…     0  2024\n\n\n\n\n\nVariables:\nPA: Planning area.\nSZ: Subzone.\nYOUNG: Ages 0–24 (0–4, 5–9, 10–14, 15–19, 20–24).\nECONOMY_ACTIVE: Ages 25–64 (25–29 … 60–64).\nAGED: Ages 65+.\nTOTAL: Sum of all age groups.\nDEPENDENCY: (YOUNG + AGED)/ECONOMY_ACTIVE ×100 as %\n2.3.4.1 Data Wrangling\n\npopdata2024 &lt;- popdata %&gt;%\n  #aggregates population counts (Pop) for each combination of planning area (PA), subzone (SZ), and age group (AG).\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP`= sum(`Pop`)) %&gt;%\n  #reshapes the table so each age group (AG) becomes its own column, with population counts as values.\n  ungroup()%&gt;%\n  pivot_wider(names_from =AG,\n              values_from = POP) %&gt;%\n# quick preview of structure\n  {glimpse(.) ; .} %&gt;%\n  #adds new columns by summing selected age-group columns\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[12])) %&gt;%\n  mutate(`ECONOMY ACTIVE` = rowSums(.[7:11]) \n         +rowSums(.[13:15])) %&gt;%\n  mutate(`AGED` = rowSums(.[16:21])) %&gt;%\n  mutate(`TOTAL` = rowSums(.[3:21])) %&gt;%\n  mutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n         /`ECONOMY ACTIVE`) %&gt;%\n  # quick preview of structure\n  {glimpse(.) ; .} %&gt;%\n  #keeps only the useful columns.\n  select (`PA`, `SZ`,`YOUNG`,\n          `ECONOMY ACTIVE`, `AGED`,\n          `TOTAL`, `DEPENDENCY`)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\n\nRows: 332\nColumns: 21\n$ PA            &lt;chr&gt; \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", …\n$ SZ            &lt;chr&gt; \"Ang Mo Kio Town Centre\", \"Cheng San\", \"Chong Boon\", \"Ke…\n$ `0_to_4`      &lt;dbl&gt; 130, 770, 610, 570, 210, 680, 210, 490, 0, 130, 0, 650, …\n$ `10_to_14`    &lt;dbl&gt; 290, 970, 870, 840, 360, 670, 370, 820, 0, 240, 0, 1030,…\n$ `15_to_19`    &lt;dbl&gt; 300, 1070, 990, 940, 450, 780, 450, 890, 0, 250, 0, 1230…\n$ `20_to_24`    &lt;dbl&gt; 280, 1190, 1130, 1020, 440, 810, 510, 810, 0, 270, 0, 14…\n$ `25_to_29`    &lt;dbl&gt; 280, 1480, 1440, 1190, 470, 1020, 530, 1060, 0, 310, 0, …\n$ `30_to_34`    &lt;dbl&gt; 280, 1890, 1580, 1370, 410, 1230, 530, 1340, 0, 270, 0, …\n$ `35_to_39`    &lt;dbl&gt; 300, 1820, 1640, 1370, 320, 1110, 420, 1210, 0, 240, 0, …\n$ `40_to_44`    &lt;dbl&gt; 420, 2080, 1590, 1550, 410, 1090, 390, 1390, 0, 290, 0, …\n$ `45_to_49`    &lt;dbl&gt; 410, 1890, 1750, 1590, 460, 1160, 500, 1520, 0, 310, 0, …\n$ `50_to_54`    &lt;dbl&gt; 440, 2080, 1770, 1690, 550, 1250, 620, 1480, 0, 350, 0, …\n$ `55_to_59`    &lt;dbl&gt; 320, 2020, 1910, 1710, 530, 1220, 570, 1320, 0, 290, 0, …\n$ `5_to_9`      &lt;dbl&gt; 240, 950, 710, 790, 350, 750, 310, 660, 0, 200, 0, 890, …\n$ `60_to_64`    &lt;dbl&gt; 310, 2040, 2050, 1680, 480, 1410, 650, 1530, 0, 310, 0, …\n$ `65_to_69`    &lt;dbl&gt; 280, 2040, 2040, 1660, 420, 1270, 660, 1560, 0, 320, 0, …\n$ `70_to_74`    &lt;dbl&gt; 260, 1970, 1940, 1600, 390, 1170, 480, 1430, 0, 240, 0, …\n$ `75_to_79`    &lt;dbl&gt; 190, 1340, 1510, 1150, 280, 860, 310, 1140, 0, 180, 0, 1…\n$ `80_to_84`    &lt;dbl&gt; 110, 830, 960, 740, 200, 590, 220, 750, 0, 110, 0, 550, …\n$ `85_to_89`    &lt;dbl&gt; 50, 380, 520, 400, 120, 310, 140, 420, 0, 70, 0, 260, 90…\n$ `90_and_over` &lt;dbl&gt; 20, 230, 300, 230, 70, 190, 100, 230, 0, 40, 0, 160, 40,…\nRows: 332\nColumns: 26\n$ PA               &lt;chr&gt; \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio…\n$ SZ               &lt;chr&gt; \"Ang Mo Kio Town Centre\", \"Cheng San\", \"Chong Boon\", …\n$ `0_to_4`         &lt;dbl&gt; 130, 770, 610, 570, 210, 680, 210, 490, 0, 130, 0, 65…\n$ `10_to_14`       &lt;dbl&gt; 290, 970, 870, 840, 360, 670, 370, 820, 0, 240, 0, 10…\n$ `15_to_19`       &lt;dbl&gt; 300, 1070, 990, 940, 450, 780, 450, 890, 0, 250, 0, 1…\n$ `20_to_24`       &lt;dbl&gt; 280, 1190, 1130, 1020, 440, 810, 510, 810, 0, 270, 0,…\n$ `25_to_29`       &lt;dbl&gt; 280, 1480, 1440, 1190, 470, 1020, 530, 1060, 0, 310, …\n$ `30_to_34`       &lt;dbl&gt; 280, 1890, 1580, 1370, 410, 1230, 530, 1340, 0, 270, …\n$ `35_to_39`       &lt;dbl&gt; 300, 1820, 1640, 1370, 320, 1110, 420, 1210, 0, 240, …\n$ `40_to_44`       &lt;dbl&gt; 420, 2080, 1590, 1550, 410, 1090, 390, 1390, 0, 290, …\n$ `45_to_49`       &lt;dbl&gt; 410, 1890, 1750, 1590, 460, 1160, 500, 1520, 0, 310, …\n$ `50_to_54`       &lt;dbl&gt; 440, 2080, 1770, 1690, 550, 1250, 620, 1480, 0, 350, …\n$ `55_to_59`       &lt;dbl&gt; 320, 2020, 1910, 1710, 530, 1220, 570, 1320, 0, 290, …\n$ `5_to_9`         &lt;dbl&gt; 240, 950, 710, 790, 350, 750, 310, 660, 0, 200, 0, 89…\n$ `60_to_64`       &lt;dbl&gt; 310, 2040, 2050, 1680, 480, 1410, 650, 1530, 0, 310, …\n$ `65_to_69`       &lt;dbl&gt; 280, 2040, 2040, 1660, 420, 1270, 660, 1560, 0, 320, …\n$ `70_to_74`       &lt;dbl&gt; 260, 1970, 1940, 1600, 390, 1170, 480, 1430, 0, 240, …\n$ `75_to_79`       &lt;dbl&gt; 190, 1340, 1510, 1150, 280, 860, 310, 1140, 0, 180, 0…\n$ `80_to_84`       &lt;dbl&gt; 110, 830, 960, 740, 200, 590, 220, 750, 0, 110, 0, 55…\n$ `85_to_89`       &lt;dbl&gt; 50, 380, 520, 400, 120, 310, 140, 420, 0, 70, 0, 260,…\n$ `90_and_over`    &lt;dbl&gt; 20, 230, 300, 230, 70, 190, 100, 230, 0, 40, 0, 160, …\n$ YOUNG            &lt;dbl&gt; 1440, 6080, 5370, 5060, 2010, 4190, 2160, 4490, 0, 12…\n$ `ECONOMY ACTIVE` &lt;dbl&gt; 2560, 14170, 12670, 11250, 3430, 8990, 3900, 10030, 0…\n$ AGED             &lt;dbl&gt; 910, 6790, 7270, 5780, 1480, 4390, 1910, 5530, 0, 960…\n$ TOTAL            &lt;dbl&gt; 4910, 27040, 25310, 22090, 6920, 17570, 7970, 20050, …\n$ DEPENDENCY       &lt;dbl&gt; 0.9179688, 0.9082569, 0.9976322, 0.9635556, 1.0174927…\n\n\n2.3.4.2 Joining the attribute data and geospatial data\n\npopdata2024 &lt;- popdata2024 %&gt;%\n  #converts PA and SZ names to uppercase so they will match the geospatial dataset’s fields (SUBZONE_N and PLN_AREA_N are uppercase).\n  mutate_at(.vars = vars(PA, SZ),\n            .funs = list(toupper)) %&gt;%\n  filter(`ECONOMY ACTIVE` &gt; 0)\n# quick preview of structure\nglimpse(popdata2024)\n\nRows: 238\nColumns: 7\n$ PA               &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO…\n$ SZ               &lt;chr&gt; \"ANG MO KIO TOWN CENTRE\", \"CHENG SAN\", \"CHONG BOON\", …\n$ YOUNG            &lt;dbl&gt; 1440, 6080, 5370, 5060, 2010, 4190, 2160, 4490, 1240,…\n$ `ECONOMY ACTIVE` &lt;dbl&gt; 2560, 14170, 12670, 11250, 3430, 8990, 3900, 10030, 2…\n$ AGED             &lt;dbl&gt; 910, 6790, 7270, 5780, 1480, 4390, 1910, 5530, 960, 5…\n$ TOTAL            &lt;dbl&gt; 4910, 27040, 25310, 22090, 6920, 17570, 7970, 20050, …\n$ DEPENDENCY       &lt;dbl&gt; 0.9179688, 0.9082569, 0.9976322, 0.9635556, 1.0174927…\n\n\nThe ECONOMY_ACTIVE column has back ticks, which is because of R’s display convention.\n\n#joins the attribute table (popdata2024) with the polygon map (mpsz) using subzone name as the key: SUBZONE_N from the map, SZ from the population data.\nmpsz_pop2024 &lt;- left_join(mpsz, popdata2024,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\nglimpse(mpsz_pop2024)\n\nRows: 332\nColumns: 11\n$ REGION_N         &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\",…\n$ PLN_AREA_N       &lt;chr&gt; \"BUKIT MERAH\", \"BUKIT MERAH\", \"OUTRAM\", \"DOWNTOWN COR…\n$ SUBZONE_N        &lt;chr&gt; \"DEPOT ROAD\", \"BUKIT MERAH\", \"CHINATOWN\", \"PHILLIP\", …\n$ SUBZONE_C        &lt;chr&gt; \"BMSZ12\", \"BMSZ02\", \"OTSZ03\", \"DTSZ04\", \"DTSZ05\", \"OT…\n$ PA               &lt;chr&gt; \"BUKIT MERAH\", \"BUKIT MERAH\", \"OUTRAM\", NA, NA, \"OUTR…\n$ YOUNG            &lt;dbl&gt; 1820, 260, 2410, NA, NA, 190, 2820, NA, 3720, NA, NA,…\n$ `ECONOMY ACTIVE` &lt;dbl&gt; 3550, 460, 5440, NA, NA, 560, 6710, NA, 7800, NA, NA,…\n$ AGED             &lt;dbl&gt; 1180, 260, 2270, NA, NA, 460, 2680, NA, 3130, NA, NA,…\n$ TOTAL            &lt;dbl&gt; 6550, 980, 10120, NA, NA, 1210, 12210, NA, 14650, NA,…\n$ DEPENDENCY       &lt;dbl&gt; 0.8450704, 1.1304348, 0.8602941, NA, NA, 1.1607143, 0…\n$ geometry         &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((103.8145 1...., MULTIPOL…\n\n\n\n#Saves the combined sf object as an .rds file, which can be reloaded later with read_rds()\nwrite_rds(mpsz_pop2024,\"data/rds/mpsz_pop2024.rds\")\n\n\n\n\n\nChoropleth mapping shows data by colouring areas such as countries, states, or census zones, using shades or patterns to represent values.\n\n\nqtm(): stands for Quick Thematic Map to plot quick, simple maps.\n\ntmap_mode(\"plot\")         #plot: static; view: interactive\n\nℹ tmap mode set to \"plot\".\n\nqtm(shp = mpsz_pop2024,\n    fill = \"DEPENDENCY\")   #attribute/column\n\n\n\n\n\n\n\n\n\n\n\ntmap elements: for detailed, highly customisable maps.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"brewer.blues\"),\n              fill.legend = tm_legend(\n                title = \"Dependency ratio\")) +\n  tm_title(\"Distribution of Dependency Ratio by Planning Subzone\") +\n  tm_layout(frame = TRUE) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scalebar() +\n  tm_grid(alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone Boundary from Urban Redevelopment Authority (URA)\\n and Popluation Data from Department of Statistics DOS\",\n             position = c(\"left\",\"bottom\"),\n             just = c(\"left\",\"bottom\"),\n             outside = TRUE)\n\n[plot mode] fit legend/component: Some legend items or map compoments do not\nfit well, and are therefore rescaled.\nℹ Set the tmap option `component.autoscale = FALSE` to disable rescaling.\n\n\n\n\n\n\n\n\n\n2.4.2.1 Drawing a base map using tm_shape().\nBy default, tmap draws polygons with a dark gray outline (gray25) and a light gray fill (gray85).\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons()\n\n\n\n\n\n\n\n\n2.4.2.2 Drawing a choropleth map using tm_polygons()\nHere is a summary of the key points of tm_polygons() defaults:\nClassification: uses the “pretty” interval method.\nColour scheme: defaults to ColorBrewer’s Blues3 palette.\nMissing values: shown in grey.\n\ntm_shape(mpsz_pop2024)+\n  tm_polygons(fill = \"DEPENDENCY\")\n\n\n\n\n\n\n\n\n2.4.2.3 Drawing a choropleth map using tm_fill() and tm_borders()\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(\"DEPENDENCY\")\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(\"DEPENDENCY\") +\n  tm_borders()\n\n\n\n\n\n\n\n\nBorders in tm_borders(): by default, polygons are outlined in light gray.\nfill_alpha: controls polygon transparency (0 = invisible, 1 = fully opaque).\nOther key arguments:\ncol: border colour\nlwd: border line width (default = 1, thin line)\nlty: border line type (default = “solid”, others like dashed, dotted)\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(\"DEPENDENCY\") +\n  tm_borders(col = \"grey60\",\n             lwd = 0.1,\n             lty = \"dashed\")\n\n\n\n\n\n\n\n\n\n\n\ntmap supports ten data classification methods for choropleth mapping: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\n2.4.3.1 Plotting choropleth maps with built-in classification methods\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\nQuantile (above) shows differences more clearly, while Equal interval is better for showing absolute value ranges but may hide variation if data are skewed.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"equal\",\n                n = 5)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\nDIY 1: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"sd\",\n                n = 5)) +\n    tm_borders(fill_alpha = 0.5)  \n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"jenks\",\n                n = 5)) +\n    tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"bclust\",\n                n = 5)) +\n    tm_borders(fill_alpha = 0.5)\n\nCommittee Member: 1(1) 2(1) 3(1) 4(1) 5(1) 6(1) 7(1) 8(1) 9(1) 10(1)\nComputing Hierarchical Clustering\n\n\n\n\n\n\n\n\n\nDIY 2:\nUsing different class numbers changes map readability. Fewer classes (2–3) give a simple overview but hide variation. Moderate classes (5–7) balance detail and clarity. More classes (10–20) seem similar to 5-7 classes overall but too many classes could reduce clarity. So 5–7 classes are best for clear and insightful choropleth maps.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 2)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 6)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 10)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 20)) +\n  tm_borders(fill_alpha = 0.5)\n\n[plot mode] fit legend/component: Some legend items or map compoments do not\nfit well, and are therefore rescaled.\nℹ Set the tmap option `component.autoscale = FALSE` to disable rescaling.\n\n\n\n\n\n\n\n\n\n2.4.3.2 Plotting Choropleth map with custom break\n\nsummary(mpsz_pop2024$DEPENDENCY)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.1905  0.7450  0.8377  0.8738  0.9366 12.7500      94 \n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00))) +\n  tm_borders(fill_alpha = 0.5)\n\nWarning: Values have found that are higher than the highest break. They are\nassigned to the highest interval\n\n\n\n\n\n\n\n\n\n\n\n\n2.4.4.1 Using ColourBrewer palette\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"brewer.greens\")) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\nUsing “-” to reverse the colour shading.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"-brewer.greens\")) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\n2.4.4.2 Cartographic Furniture\nThe code chunk below uses tm_compass(), tm_scale_bar(), tm_grid() and tm_credit() to draw cartographic furniture like compass, scale bar, grid lines.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5)) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scalebar() +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: data.gov.sg & Singstat\",\n            position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n\n2.4.5.1 Map Legend\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5),\n              fill.legend = tm_legend(\n                title = \"Dependency ratio\")) +\n  tm_pos_auto_in() +\n  tm_borders(fill_alpha = 0.5) +\n  tm_compass(type =\"8star\", size = 2) +\n  tm_scalebar() +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: data.gov.sg & singstat\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\n\n2.4.5.2 Map style\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"-brewer.greens\")) + \n  tm_borders(fill_alpha = 0.5) + \n  tmap_style(\"natural\")\n\nstyle set to \"natural\"\n\n\nother available styles are: \"white\" (tmap default), \"gray\", \"cobalt\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\"\n\n\ntmap v3 styles: \"v3\" (tmap v3 default), \"gray_v3\", \"natural_v3\", \"cobalt_v3\", \"albatross_v3\", \"beaver_v3\", \"bw_v3\", \"classic_v3\", \"watercolor_v3\"\n\n\n\n\n\n\n\n\n\n\n#reset to default style; options: white (default), gray, natural, classic, cobalt, albatross, beaver, and bw (black & white).\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"-brewer.greens\")) + \n  tm_borders(fill_alpha = 0.5) + \n  tmap_style(\"white\")\n\nstyle set to \"white\" (tmap default)\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\"\n\n\ntmap v3 styles: \"v3\" (tmap v3 default), \"gray_v3\", \"natural_v3\", \"cobalt_v3\", \"albatross_v3\", \"beaver_v3\", \"bw_v3\", \"classic_v3\", \"watercolor_v3\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhy my maps are arranged vertically but the ones in example are shown horizontally?\n\n# assigning two variables to the visual variable (fill)\ntm_shape(mpsz_pop2024) + \n  tm_polygons(\n    fill = c(\"YOUNG\", \"AGED\"),\n    fill.legend = \n      tm_legend(position = tm_pos_in(\n        \"right\", \"bottom\")),\n    fill.scale = tm_scale_intervals(\n      style = \"equal\", \n      n = 5,\n      values = \"brewer.blues\")) +\n  tm_borders(fill_alpha = 0.5) +\n  tmap_style(\"natural\")\n\nstyle set to \"natural\"\n\n\nother available styles are: \"white\" (tmap default), \"gray\", \"cobalt\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\"\n\n\ntmap v3 styles: \"v3\" (tmap v3 default), \"gray_v3\", \"natural_v3\", \"cobalt_v3\", \"albatross_v3\", \"beaver_v3\", \"bw_v3\", \"classic_v3\", \"watercolor_v3\"\n\n\n\n\n\n\n\n\n\n\n\n\nIn tmap_arrange(), asp controls the panel aspect ratio (height ÷ width): asp = 1 makes panels square, asp &gt; 1 makes them taller than wide, asp &lt; 1 makes them wider than tall, and asp = 0 allows free stretching. The ncol argument sets how many maps are placed per row.\n\nyoungmap &lt;- tm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"YOUNG\",\n              fill.legend = tm_legend(\n                position = tm_pos_in(\n                  \"right\", \"bottom\"),\n                item.height = 0.8),\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.blues\")) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"Distribution of young population\")\n\nagedmap &lt;- tm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"AGED\",\n              fill.legend = tm_legend(\n                position = tm_pos_in(\n                  \"right\", \"bottom\"),\n                item.height = 0.8),\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.blues\")) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"Distribution of young population\")\n\ntmap_arrange(youngmap, agedmap, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\nThe code below uses tm_facets() to split the map into facets by region name, arranged in 2 rows × 3 columns; each facet has its own coordinate system (free.coords), and subzones not in that facet are dropped (drop.units).\nIn R, c() stands for combine. It creates a vector by combining multiple values into one object.\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(fill = \"DEPENDENCY\",\n          fill.scale = tm_scale_intervals(\n            style = \"quantile\",\n            values = \"brewer.blues\")) + \n  tm_facets(by = \"REGION_N\",\n            nrow = 2, \n            ncols = 3,\n            free.coords=TRUE, \n            drop.units=TRUE) +\n  tm_layout(legend.show = TRUE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\n\nmpsz_pop2024 %&gt;%\n  filter(REGION_N == \"CENTRAL REGION\") %&gt;%\n  tm_shape() +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.greens\"),\n              fill.legend = tm_legend()) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\nLegend charts are small charts that are added to the map, usually in addition to legends. Arguments that could be assigned to fill.chart are tm_chart_histogram(), tm_chart_bar(), tm_chart_donut(),tm_chart_violin(), tm_chart_box(), tm_chart_none(),tm_chart_heatmap().\n\nmpsz_pop2024 %&gt;%\n  filter(REGION_N == \"CENTRAL REGION\") %&gt;%\n  tm_shape() +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.greens\"),\n              fill.legend = tm_legend(),\n              fill.chart = tm_chart_box()) + #other options \n  tm_borders() +\n  tm_layout(asp = 0.8)\n\n\n\n\n\n\n\n\n\nmpsz_selected &lt;- mpsz_pop2024 %&gt;%\n  filter(REGION_N == \"CENTRAL REGION\")\n\nstats &lt;- boxplot.stats(mpsz_selected$DEPENDENCY)\n\noutlier_vals &lt;- stats$out #$out gives the outlier values of DEPENDENCY (those outside 1.5×IQR rule).\n\noutlier_sf &lt;- mpsz_selected[mpsz_selected$DEPENDENCY %in% outlier_vals, ]\n\ntm_shape(mpsz_selected) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.blues\"),\n              fill.legend = tm_legend(),\n              fill.chart = tm_chart_box()) +\n  tm_borders(fill_alpha = 0.5) +\ntm_shape(outlier_sf) +\n  tm_borders(col =\"red\", lwd = 2) +\n  tm_text(\"SUBZONE_N\", col = \"red\", size = 0.7) +\n  tm_layout(asp = 0.8)\n\n\n\n\n\n\n\n\n\n\n\nInteractive maps (tmap_mode(“view”)) let users zoom, pan, and click for details.\n\nregion_selected &lt;- mpsz_pop2024 %&gt;%\n  filter(REGION_N== \"CENTRAL REGION\")\nregion_bbox &lt;- st_bbox(region_selected)\n\nstats &lt;- boxplot.stats(region_selected$DEPENDENCY)\noutlier_vals &lt;- stats$out\noutlier_sf &lt;- region_selected[region_selected$DEPENDENCY %in% outlier_vals, ]\n\ntmap_mode(\"view\")\n\nℹ tmap mode set to \"view\".\n\ntm_shape(region_selected,\n         bbox = region_bbox) +\n  tm_fill(\"DEPENDENCY\",\n          id = \"SUBZONE_N\",\n          popup.vars = c(\n            \"Name\" = \"SUBZONE_N\",\n            \"Dependnecy\" = \"DEPENDENCY\")) +\n  tm_borders() +\n  tm_shape(outlier_sf) +\n  tm_borders(col = \"red\", lwd = 2)\n\n\n\n\n\n\nThe code chunk below adds tmap_mode(“plot”) after producing the interactive map to reset to static mode for subsequent maps.\n\ntmap_mode(\"plot\")\n\nℹ tmap mode set to \"plot\".\n\n\nTHe code chunk blow uses tm_view(set_zoom_limits = c(12,14)) to control zoom freedom and keep the view focused.\n\nregion_selected &lt;- mpsz_pop2024 %&gt;%\n  filter(REGION_N== \"CENTRAL REGION\")\nregion_bbox &lt;- st_bbox(region_selected)\n\nstats &lt;- boxplot.stats(region_selected$DEPENDENCY)\noutlier_vals &lt;- stats$out\noutlier_sf &lt;- region_selected[region_selected$DEPENDENCY %in% outlier_vals, ]\n\ntmap_mode(\"view\")\n\nℹ tmap mode set to \"view\".\n\ntm_shape(region_selected,\n         bbox = region_bbox) +\n  tm_fill(\"DEPENDENCY\",\n          id = \"SUBZONE_N\",\n          popup.vars = c(\n            \"Name\" = \"SUBZONE_N\",\n            \"Dependnecy\" = \"DEPENDENCY\")) +\n  tm_borders() +\n  tm_shape(outlier_sf) +\n  tm_borders(col = \"red\", lwd = 2) +\n  tm_view(set_zoom_limits = c(12,14))\n\n\n\n\n\n\n\n#reset to static maps\ntmap_mode(\"plot\")\n\nℹ tmap mode set to \"plot\".\n\n\nThe end."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#getting-started-installing-and-launching-r-packages",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#getting-started-installing-and-launching-r-packages",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "The following code chunk uses the p_load() function from the pacman package to check whether the sf and tidyverse packages are installed. If they are, it loads them into the R session; if not, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#importing-the-data",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#importing-the-data",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "The geospatial datasets include shapefiles and KML file. (The reason of selecting file format). The geospatial data consist of the Master Plan 2014 Subzone Boundary (Web), Pre-Schools Location from data.gov.sg, and Cycling Path from LTA DataMall. The aspatial dataset is the Singapore Airbnb listings from Inside Airbnb.\nR itself is case-sensitive, especially for object and function names. Whether file paths are case-sensitive depends on the operating system, e.g. On Windows: it is not case-sensitive.\n\n1.4.1 The code below uses the st_read() function from the sf package to load the Master Plan 2014 Subzone Boundary (Web) shapefile as a polygon data frame. For shapefiles, the .shp extension does not need to be specified in the code. Both absolute and relative paths can be used, but a relative path is applied here to keep the code cleaner and shorter.\n\n\nmpsz = st_read(dsn = \"data/geospatial\",\n               layer = \"mp14_SUBZONE_WEB_PL\")\n\nReading layer `mp14_SUBZONE_WEB_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n1.4.2 Similarly, the code below uses st_read() to import the Pre-Schools Location shapefile as a polyline data frame.\n\n\ncyclingpath = st_read(dsn = \"data/geospatial\",\n                      layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4651 features and 19 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\n\n1.4.3 The code below uses st_read() to import the Pre-Schools Location in KML format as point feature data frame into R. When importing a KML file, the .kml extension must be included.\n\nsvy21 vs wgs84?\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#checking-the-content-of-a-simple-feature-data-frame",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#checking-the-content-of-a-simple-feature-data-frame",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "Both two code chunks display the basic information about the dataset. However, it is more common to use the second approach.\n\nmpsz$geom\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\nst_geometry(mpsz)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nAlthough it is mentioned as one of the ways to retrieve the first 5 records like the two code chunks above, but here we see seems to be ID column?\n\nmpsz[[1]]\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108\n[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126\n[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144\n[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162\n[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180\n[181] 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198\n[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216\n[217] 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234\n[235] 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252\n[253] 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270\n[271] 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288\n[289] 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306\n[307] 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323\n\n\nFurthermore, the code below uses glimpse() of dplyr to display more detailed attribute information in the data frame.\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nLastly, the code below uses the head() function from base R (similar to Python, where the argument n can be set manually) to display the first few rows of the data frame for a quick overview.\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30..."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#plotting-the-geo-spatial-data",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#plotting-the-geo-spatial-data",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "Visualising an sf data frame is straightforward: using the plot() of Base R function automatically generates small coloured maps of the geometries by each attribute (field), while excluding non-informative columns such as the OBJECTID.\n\nplot(mpsz)\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\nMeanwhile, the code chunk below can be used to display the silhouette of the map:\n\nplot(st_geometry(mpsz))\n\n\n\n\n\n\n\n\nWe can also focus on a specific attribute by using the code chunk below:\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\n\n\nTo get a polished view of the data, we can use the tmap package, but it takes longer processing time:\n\n#library(tmap)\n#tm_shape(mpsz) +\n  #tm_fill(\"PLN_AREA_N\")+\n  #tm_borders()\n\n## comment out to save time\n\nBelow we quickly plot the preschool and cyclingpath.\n\nplot(st_geometry(preschool))\n\n\n\n\n\n\n\nplot(st_geometry(cyclingpath))\n\n\n\n\n\n\n\n\nBelow we can plot the cyclingpath layer on the top of the mpsz layer by using add argument.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(cyclingpath),\n     add = TRUE, col = \"Blue\")\n\n\n\n\n\n\n\n\nWhen trying the code with preschool, the preschool points does not appear on the subzone map because the two layers use different CRSs (mpsz in SVY21 and preschool in WGS84), transformation of preschool into the same CRS as mpsz is required before plotting the aligned map.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool),\n     add = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#projection-transformation",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#projection-transformation",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "st_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nst_crs(preschool)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\nst_crs(cyclingpath)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nThe above funtion st_crs() reveals that the layers of mpsz and cyclingpath are indeed in SVY21, but they are missing the correct EPSG code (3414). Assigning EPSG 3414 by using st_set_crs() of sf packages ensures the CRS is properly identified, as below:\n\nmpsz &lt;- st_set_crs(mpsz,3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nOn the other hand, the code below using st_transform() reprojects the preschool data from the WGS84 to SVY21.\n\npreschool &lt;- st_transform(preschool,\n                          crs = 3414)\n\nBy display the preview of preschool sf data, we can confirm its CRS is SVY21 now.\n\nst_geometry(preschool)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)\n\n\nHere we could align both data together by setting add argument TRUE.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool), add = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#importing-and-converting-an-aspatial-data",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#importing-and-converting-an-aspatial-data",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "1.8.1 The chunk below first uses read_csv() from readr to import listing.csv into R as a tibble data frame, and then applies list() from base R to preview the first 10 records, similar to glimpse() of dplyr.\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\n\nRows: 3659 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nlist(listings)\n\n[[1]]\n# A tibble: 3,659 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Ensuite …  367042 Belinda   East Region         Tampines          1.35\n 2  71896 B&B  Roo…  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Room 2-n…  367042 Belinda   East Region         Tampines          1.35\n 4 275343 10min wa… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 15 mins … 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 294281 5 mins w… 1521514 Elizabeth Central Region      Newton            1.31\n 7 324945 Comforta… 1439258 Kay       Central Region      Bukit Merah       1.29\n 8 330095 Relaxing… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 344803 Budget s…  367042 Belinda   East Region         Tampines          1.35\n10 369141 5mins fr… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,649 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n1.8.2 The code chunk below uses st_as_sf() of sf package to convert the listings data frame into a simple feature data frame. Specifically the coordinates are first defined in WGS84 (EPSG:4326, longitude/latitude in degrees) and then reprojected into Singapore’s SVY21 system (EPSG:3414, X/Y in metres).\n\nlistings_sf &lt;- st_as_sf(listings,\n                        coords = c(\"longitude\", \"latitude\"),\n                        crs = 4326) %&gt;% #used to nest st_transform() \n  st_transform(crs = 3414)\n\n\nglimpse(listings_sf)\n\nRows: 3,659\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 29…\n$ name                           &lt;chr&gt; \"Ensuite Room (Room 1 & 2) near EXPO\", …\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 143, NA, 76, NA, NA, 85, NA, NA, 41, 79…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 180, 180, 92, 180, 180, 92,…\n$ number_of_reviews              &lt;dbl&gt; 19, 24, 46, 20, 16, 131, 17, 5, 60, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0.10, 0.80, 0.1…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 58, 5, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 90, 79, 90, 153, 153, 365, 153, 153, 36…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, \"S039…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…\n\n\nDIY: the code chuck below plots listings_sf onto mpsz layer. The map looks better when ploting mpsz first and then listings_sf, because the polygons give context (the “base map”), and the points can be layered on top without being hidden. Thus better order is polygons first, points later.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(listings_sf), add = TRUE)\n\n\n\n\n\n\n\n\n\n#plot(st_geometry(listings_sf))\n#plot(st_geometry(mpsz), add = TRUE)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#geoprocessing-with-sf-package",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#geoprocessing-with-sf-package",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "Task: compute the total land area to reserve for a 5-m corridor/shoulder on both sides of the cycling paths.\n&lt;- assignment (always use this for storing values/importing data).\n= function arguments (inside function calls).\nSolution: Step 1: st_buffer() of sf package: 5-metre buffers of reserved land on both sides of existing cycling path.\n\n# quick review of the geometry type\nst_geometry_type(cyclingpath, by_geometry = FALSE)\n\n[1] MULTILINESTRING\n18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE\n\n\n\n# quick overview of the cycling path data\nglimpse(cyclingpath)\n\nRows: 4,651\nColumns: 20\n$ PATH_TYPE  &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ LVL_NUM    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ AGENCY_IMP &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ AGENCY_MAI &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ GAZETTE_DA &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ LAUNCH_DAT &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ MISC       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PKG_REF    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ AGENCY_M_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ AGENCY_I_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ LVL_NUM_DE &lt;chr&gt; \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\",…\n$ PATH_TYPE_ &lt;chr&gt; \"Shared Path\", \"Shared Path\", \"Shared Path\", \"Shared Path\",…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\n\nbuffer_cycling &lt;- st_buffer(\n  cyclingpath, dist=5, nQuadSegs = 30)\n\n#st_buffer()builds polygons at a fixed offset from a geometry.\n#cyclingpath is input, multilinestrings layer\n#dist=5, buffer distance in the layer's units. \n#Here CRS is SVY221 in metre, thus no transformation is required.\n#nQuadSegs = 30, higher the value, smoother the curve in the buffer around corners or ends.\n#stands for “number of line segments to use to approximate a quarter circle\".\n\nStep 2: use st_area() to calculate each area of the buffers\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n#st_area() returns area of each feature in the geometry column\n# units vector (m^2)\n#buffer_cycling$AREA adds a new attribute column AREA\n\nAlternatively, code uses tidyverse\n\nbuffer_cycling &lt;- buffer_cycling %&gt;%\n  mutate(AREA = st_area(geometry))\n# mutate() of dplyr, just like the $AREA, creates a new column AREA\n#geometry is the sf geometry column; st_area(geometry) computes area for each row.\n\nStep 3: sum() of Base R to add up all AREA values.\nWhat if the areas are overlapped?\n\nsum(buffer_cycling$AREA)\n\n3561648 [m^2]\n\n\nStep 4: plotting the buffer by a selected planning subzone: Tampines West\n\nfilter() of dplyr package to select the subzone\n\n\n#quick overview of the mpsz\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\nmpsz_selected &lt;- mpsz %&gt;%\n  filter(SUBZONE_N == \"TAMPINES WEST\")\n#quick overview of the newly selected subzone\nst_geometry(mpsz_selected)\n\nGeometry set for 1 feature \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 38199.84 ymin: 35355.22 xmax: 40642.12 ymax: 38054.52\nProjected CRS: SVY21 / Singapore TM\n\n\nMULTIPOLYGON (((39918.43 35362.32, 39909.84 353...\n\n#creating a plot for the subzone in general\nplot(st_geometry(mpsz_selected))\n\n\n\n\n\n\n\n\n\nst_intersection() of sf package to clip clycing buffers within the subzone. Both layers are in the SVY21. However, since EPSG code is missing in buffer_cycling, we need to assign the code 3414 to it before performing intersection.\n\n\n# checking features of the two layers\nst_crs(buffer_cycling)$epsg\n\n[1] NA\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\nst_crs(mpsz_selected)$epsg\n\n[1] 3414\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\n# EPSG assignment, or use 3414 as second parameter\nbuffer_cycling &lt;- st_set_crs(buffer_cycling, st_crs(mpsz_selected))\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\n\n\nbuffer_cycling_selected &lt;- st_intersection(\n  buffer_cycling, mpsz_selected)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n#st_intersection(x, y) returns a new sf object = overlapping parts of x and y\n\n\nplot() to create the plot\n\n\nplot(st_geometry(buffer_cycling_selected))\n\n\n\n\n\n\n\n\nDONE!\n\n\n\nSolution:\nStep 1: Use st_intersects() from the sf package to identify pre-schools located inside each subzone. Then, use the length() function from base R to calculate the number of pre-school points within each subzone. The function st_intersects() returns a list of intersections. While length() returns only the total number of subzones, the lengths() function works on a list and returns a vector with the length of each element.\n\n#perform an overview of both data frames first\nglimpse(preschool)\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [m]&gt; POINT Z (25089.46 31299.16 0), POINT Z (27189.07 327…\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n#show the outputs individually\nst_intersects(mpsz, preschool)\n\nSparse geometry binary predicate list of length 323, where the\npredicate was `intersects'\nfirst 10 elements:\n 1: (empty)\n 2: 764, 1258, 1503, 1562, 1670, 2035\n 3: (empty)\n 4: 151, 748, 1140, 1844, 2209\n 5: 190, 1496, 1924\n 6: 237, 238, 260, 264, 283, 292, 391, 714, 949, 1494, ...\n 7: 766, 1088, 1254, 1867, 2021\n 8: 498\n 9: 363, 399, 642, 1696, 1734, 1757, 1915, 1941, 2142, 2232, ...\n 10: 1470\n\nlength(st_intersects(mpsz, preschool))\n\n[1] 323\n\nlengths(st_intersects(mpsz, preschool))\n\n  [1]  0  6  0  5  3 13  5  1 11  1  4  2  0  1  6  0  0  0  0  4  0  1  0  5  4\n [26]  1  7  2 12  7  0  0  4  0  4 10  1  3  0  6  0  3  1  0  3  0  4  1  9  0\n [51]  1  4  1  2  4  0  2  1  2  0  3  0  2  6  1  0 13  3 14  1  4  9  1  5  0\n [76]  0  3 11  0  0  1  0  3  1  2  0  0  5  0  7  3  4  0  0  7  0  0  2  0  4\n[101] 10  0 14  0  3  2  2 29 18 21  0  0  5  5  0 10 23 22  7  2  1  0  0  0  6\n[126]  6  3  0  0  8  5  5  8  6  5  5 11  9  8  0  3  8  1  0  3 24  0  7 18 11\n[151] 10 28 13  4  0  6  6  0  2  8  6  0 40  4 21  0 36 14  4 16 11 13  5  7  9\n[176] 12 30  0  0 11 13 38 11  0  8 19  5  5 72  9  0  4 32  7  3  3  9  3 38 18\n[201]  0 15  0 12  4 11 23 16  0  7 21 19  8 20 15 26  6 23 13  6  0 13  5 12 10\n[226]  7  6  7  1  8 25  3  8  0  0 18 13 10 16  9  9 17  5  1  3 22  4 12  4  9\n[251]  3  0 17 10  4  0  0  9 16 27  0 16 22 16  0 13 23  0  2  0  0 33 20  0 22\n[276]  6  8  5  6  0  0 14 21 20  1  0 22  2  0 54 27  1 10  0  0 10  0  0  0 12\n[301]  0  0  1  0 20 19  9 12  2 15  0  0  0  1  0  0  3  0  0  4  1  0  0\n\n#combine the two steps into one-line code\nmpsz$`PreSch Count` &lt;- lengths(st_intersects(mpsz, preschool))\n\n#alternatively, using tidyverse way\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Count`= lengths(st_intersects(mpsz,preschool)))\n\nNote: st_intersects() is a spatial predicate that quickly checks relationships between features and returns indices (or a list) showing which features intersect, without creating new geometries. In contrast, st_intersection() performs a full geometric overlay, generating new sf features that represent the actual overlapping geometries and carrying attributes from both input layers, which is more computationally intensive.\n\n# statistical summary for the new column\nsummary(mpsz$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n#top_n() of dplyr package to see the sub zone with the most number of pre-school\ntop_n(mpsz, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\nStep 2: The code chunk below uses st_area() from the sf package to calculate the area of each subzone, returning values in square metres because the CRS (SVY21) is in metres. Note that the SHAPE_Area field shown in the glimpse(mpsz) output is a precomputed attribute from the original dataset and may not be accurate for current analysis; we rely on st_area() instead.\n\nmpsz$AREA &lt;- mpsz %&gt;%\n  st_area()\n\nsummary(mpsz$AREA)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   39438   628261  1229894  2420882  2106483 69748299 \n\n\nThe code chunk below computes preschool density per km2 ( 1km2 = 1,000,000m2). We convert to per km2 to make the numbers comparable and readable.\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/AREA * 1000000)\n\n#quick overview of the stats for the new column\nsummary(mpsz$`PreSch Density`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nStep 3: EDA using ggplot2\n\nUse hist() of R Graphics to plot a histogram of the distribution of PreSch Density.\n\n\nhist(mpsz$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nuse ggplot2 functions to provide informative visualisation.\n\nb1. create a histogram\n\n#initiates the ggplot using mpsz data fram, set x-axis\nggplot(data=mpsz,\n       aes(x = as.numeric(`PreSch Density`))) +\n  #adds a histogram layer, with bin numbers, colour and fill colour\n  geom_histogram(bins = 20,\n                 color = \"black\",\n                 fill = \"lightblue\") + \n  #adds labels such as title, subtitle, and for x, y axis\n  labs(title = \"Are pre-school evenly distrubted in Singapore?\",\n      subtitle = \"There are many planning subzones with a single pre-school, on the other hand,\\nthere are seven planning subzones with at least 30 or more pre-schools.\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\n\n\n\nb2. create a scatterplot for PreSch Density and PreSch Count.\n\n#starts a ggplot with mpsz, and maps x to PreSch Density and y to PreSch Count.\n#Uses as.numeric() to drop units from PreSch Density and coerce it to plain numbers\nggplot(data=mpsz,\n       aes(y = `PreSch Count`,\n           x = as.numeric(`PreSch Density`))) +\n  #adds points and colours\n  geom_point(shape =21,\n             color =\"black\",\n             fill = \"lightblue\") +\n  #sets the range of data from 0 to 40.\n  xlim(0,40) +\n  ylim(0,40) + \n  #adds labels\n  labs(title =\"\",\n       x = \"Pre-school density (per km sq)\",\n       y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nThe End."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#ex-1-geospatial-data-science-with-r",
    "href": "Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#ex-1-geospatial-data-science-with-r",
    "title": "Hands-on Exercise 01",
    "section": "",
    "text": "The following code chunk uses the p_load() function from the pacman package to check whether the sf and tidyverse packages are installed. If they are, it loads them into the R session; if not, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tidyverse)\n\n\n\n\nThe geospatial datasets include shapefiles and KML file. (The reason of selecting file format). The geospatial data consist of the Master Plan 2014 Subzone Boundary (Web), Pre-Schools Location from data.gov.sg, and Cycling Path from LTA DataMall. The aspatial dataset is the Singapore Airbnb listings from Inside Airbnb.\nR itself is case-sensitive, especially for object and function names. Whether file paths are case-sensitive depends on the operating system, e.g. On Windows: it is not case-sensitive.\n\n1.4.1 The code below uses the st_read() function from the sf package to load the Master Plan 2014 Subzone Boundary (Web) shapefile as a polygon data frame. For shapefiles, the .shp extension does not need to be specified in the code. Both absolute and relative paths can be used, but a relative path is applied here to keep the code cleaner and shorter.\n\n\nmpsz = st_read(dsn = \"data/geospatial\",\n               layer = \"mp14_SUBZONE_WEB_PL\")\n\nReading layer `mp14_SUBZONE_WEB_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n1.4.2 Similarly, the code below uses st_read() to import the Pre-Schools Location shapefile as a polyline data frame.\n\n\ncyclingpath = st_read(dsn = \"data/geospatial\",\n                      layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4651 features and 19 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\n\n1.4.3 The code below uses st_read() to import the Pre-Schools Location in KML format as point feature data frame into R. When importing a KML file, the .kml extension must be included.\n\nsvy21 vs wgs84?\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\n\n\nBoth two code chunks display the basic information about the dataset. However, it is more common to use the second approach.\n\nmpsz$geom\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\nst_geometry(mpsz)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nAlthough it is mentioned as one of the ways to retrieve the first 5 records like the two code chunks above, but here we see seems to be ID column?\n\nmpsz[[1]]\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108\n[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126\n[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144\n[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162\n[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180\n[181] 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198\n[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216\n[217] 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234\n[235] 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252\n[253] 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270\n[271] 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288\n[289] 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306\n[307] 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323\n\n\nFurthermore, the code below uses glimpse() of dplyr to display more detailed attribute information in the data frame.\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nLastly, the code below uses the head() function from base R (similar to Python, where the argument n can be set manually) to display the first few rows of the data frame for a quick overview.\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n\n\n\n\n\nVisualising an sf data frame is straightforward: using the plot() of Base R function automatically generates small coloured maps of the geometries by each attribute (field), while excluding non-informative columns such as the OBJECTID.\n\nplot(mpsz)\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\nMeanwhile, the code chunk below can be used to display the silhouette of the map:\n\nplot(st_geometry(mpsz))\n\n\n\n\n\n\n\n\nWe can also focus on a specific attribute by using the code chunk below:\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\n\n\nTo get a polished view of the data, we can use the tmap package, but it takes longer processing time:\n\n#library(tmap)\n#tm_shape(mpsz) +\n  #tm_fill(\"PLN_AREA_N\")+\n  #tm_borders()\n\n## comment out to save time\n\nBelow we quickly plot the preschool and cyclingpath.\n\nplot(st_geometry(preschool))\n\n\n\n\n\n\n\nplot(st_geometry(cyclingpath))\n\n\n\n\n\n\n\n\nBelow we can plot the cyclingpath layer on the top of the mpsz layer by using add argument.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(cyclingpath),\n     add = TRUE, col = \"Blue\")\n\n\n\n\n\n\n\n\nWhen trying the code with preschool, the preschool points does not appear on the subzone map because the two layers use different CRSs (mpsz in SVY21 and preschool in WGS84), transformation of preschool into the same CRS as mpsz is required before plotting the aligned map.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool),\n     add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nst_crs(preschool)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\nst_crs(cyclingpath)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nThe above funtion st_crs() reveals that the layers of mpsz and cyclingpath are indeed in SVY21, but they are missing the correct EPSG code (3414). Assigning EPSG 3414 by using st_set_crs() of sf packages ensures the CRS is properly identified, as below:\n\nmpsz &lt;- st_set_crs(mpsz,3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nOn the other hand, the code below using st_transform() reprojects the preschool data from the WGS84 to SVY21.\n\npreschool &lt;- st_transform(preschool,\n                          crs = 3414)\n\nBy display the preview of preschool sf data, we can confirm its CRS is SVY21 now.\n\nst_geometry(preschool)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)\n\n\nHere we could align both data together by setting add argument TRUE.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool), add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n1.8.1 The chunk below first uses read_csv() from readr to import listing.csv into R as a tibble data frame, and then applies list() from base R to preview the first 10 records, similar to glimpse() of dplyr.\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\n\nRows: 3659 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nlist(listings)\n\n[[1]]\n# A tibble: 3,659 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Ensuite …  367042 Belinda   East Region         Tampines          1.35\n 2  71896 B&B  Roo…  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Room 2-n…  367042 Belinda   East Region         Tampines          1.35\n 4 275343 10min wa… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 15 mins … 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 294281 5 mins w… 1521514 Elizabeth Central Region      Newton            1.31\n 7 324945 Comforta… 1439258 Kay       Central Region      Bukit Merah       1.29\n 8 330095 Relaxing… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 344803 Budget s…  367042 Belinda   East Region         Tampines          1.35\n10 369141 5mins fr… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,649 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n1.8.2 The code chunk below uses st_as_sf() of sf package to convert the listings data frame into a simple feature data frame. Specifically the coordinates are first defined in WGS84 (EPSG:4326, longitude/latitude in degrees) and then reprojected into Singapore’s SVY21 system (EPSG:3414, X/Y in metres).\n\nlistings_sf &lt;- st_as_sf(listings,\n                        coords = c(\"longitude\", \"latitude\"),\n                        crs = 4326) %&gt;% #used to nest st_transform() \n  st_transform(crs = 3414)\n\n\nglimpse(listings_sf)\n\nRows: 3,659\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 29…\n$ name                           &lt;chr&gt; \"Ensuite Room (Room 1 & 2) near EXPO\", …\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 143, NA, 76, NA, NA, 85, NA, NA, 41, 79…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 180, 180, 92, 180, 180, 92,…\n$ number_of_reviews              &lt;dbl&gt; 19, 24, 46, 20, 16, 131, 17, 5, 60, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0.10, 0.80, 0.1…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 58, 5, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 90, 79, 90, 153, 153, 365, 153, 153, 36…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, \"S039…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…\n\n\nDIY: the code chuck below plots listings_sf onto mpsz layer. The map looks better when ploting mpsz first and then listings_sf, because the polygons give context (the “base map”), and the points can be layered on top without being hidden. Thus better order is polygons first, points later.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(listings_sf), add = TRUE)\n\n\n\n\n\n\n\n\n\n#plot(st_geometry(listings_sf))\n#plot(st_geometry(mpsz), add = TRUE)\n\n\n\n\n\n\nTask: compute the total land area to reserve for a 5-m corridor/shoulder on both sides of the cycling paths.\n&lt;- assignment (always use this for storing values/importing data).\n= function arguments (inside function calls).\nSolution:\nStep 1: st_buffer() of sf package: 5-metre buffers of reserved land on both sides of existing cycling path.\n\n# quick review of the geometry type\nst_geometry_type(cyclingpath, by_geometry = FALSE)\n\n[1] MULTILINESTRING\n18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE\n\n\n\n# quick overview of the cycling path data\nglimpse(cyclingpath)\n\nRows: 4,651\nColumns: 20\n$ PATH_TYPE  &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ LVL_NUM    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ AGENCY_IMP &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ AGENCY_MAI &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ GAZETTE_DA &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ LAUNCH_DAT &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ MISC       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PKG_REF    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ AGENCY_M_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ AGENCY_I_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ LVL_NUM_DE &lt;chr&gt; \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\",…\n$ PATH_TYPE_ &lt;chr&gt; \"Shared Path\", \"Shared Path\", \"Shared Path\", \"Shared Path\",…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\n\nbuffer_cycling &lt;- st_buffer(\n  cyclingpath, dist=5, nQuadSegs = 30)\n\n#st_buffer()builds polygons at a fixed offset from a geometry.\n#cyclingpath is input, multilinestrings layer\n#dist=5, buffer distance in the layer's units. \n#Here CRS is SVY221 in metre, thus no transformation is required.\n#nQuadSegs = 30, higher the value, smoother the curve in the buffer around corners or ends.\n#stands for “number of line segments to use to approximate a quarter circle\".\n\nStep 2: use st_area() to calculate each area of the buffers\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n#st_area() returns area of each feature in the geometry column\n# units vector (m^2)\n#buffer_cycling$AREA adds a new attribute column AREA\n\nAlternatively, code uses tidyverse\n\nbuffer_cycling &lt;- buffer_cycling %&gt;%\n  mutate(AREA = st_area(geometry))\n# mutate() of dplyr, just like the $AREA, creates a new column AREA\n#geometry is the sf geometry column; st_area(geometry) computes area for each row.\n\nStep 3: sum() of Base R to add up all AREA values.\nWhat if the areas are overlapped?\n\nsum(buffer_cycling$AREA)\n\n3561648 [m^2]\n\n\nStep 4: plotting the buffer by a selected planning subzone: Tampines West\n\nfilter() of dplyr package to select the subzone\n\n\n#quick overview of the mpsz\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\nmpsz_selected &lt;- mpsz %&gt;%\n  filter(SUBZONE_N == \"TAMPINES WEST\")\n#quick overview of the newly selected subzone\nst_geometry(mpsz_selected)\n\nGeometry set for 1 feature \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 38199.84 ymin: 35355.22 xmax: 40642.12 ymax: 38054.52\nProjected CRS: SVY21 / Singapore TM\n\n\nMULTIPOLYGON (((39918.43 35362.32, 39909.84 353...\n\n#creating a plot for the subzone in general\nplot(st_geometry(mpsz_selected))\n\n\n\n\n\n\n\n\n\nst_intersection() of sf package to clip clycing buffers within the subzone. Both layers are in the SVY21. However, since EPSG code is missing in buffer_cycling, we need to assign the code 3414 to it before performing intersection.\n\n\n# checking features of the two layers\nst_crs(buffer_cycling)$epsg\n\n[1] NA\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\nst_crs(mpsz_selected)$epsg\n\n[1] 3414\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\n# EPSG assignment, or use 3414 as second parameter\nbuffer_cycling &lt;- st_set_crs(buffer_cycling, st_crs(mpsz_selected))\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\n\n\nbuffer_cycling_selected &lt;- st_intersection(\n  buffer_cycling, mpsz_selected)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n#st_intersection(x, y) returns a new sf object = overlapping parts of x and y\n\n\nplot() to create the plot\n\n\nplot(st_geometry(buffer_cycling_selected))\n\n\n\n\n\n\n\n\nDONE!\n\n\n\nSolution:\nStep 1: Use st_intersects() from the sf package to identify pre-schools located inside each subzone. Then, use the length() function from base R to calculate the number of pre-school points within each subzone. The function st_intersects() returns a list of intersections. While length() returns only the total number of subzones, the lengths() function works on a list and returns a vector with the length of each element.\n\n#perform an overview of both data frames first\nglimpse(preschool)\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [m]&gt; POINT Z (25089.46 31299.16 0), POINT Z (27189.07 327…\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n#show the outputs individually\nst_intersects(mpsz, preschool)\n\nSparse geometry binary predicate list of length 323, where the\npredicate was `intersects'\nfirst 10 elements:\n 1: (empty)\n 2: 764, 1258, 1503, 1562, 1670, 2035\n 3: (empty)\n 4: 151, 748, 1140, 1844, 2209\n 5: 190, 1496, 1924\n 6: 237, 238, 260, 264, 283, 292, 391, 714, 949, 1494, ...\n 7: 766, 1088, 1254, 1867, 2021\n 8: 498\n 9: 363, 399, 642, 1696, 1734, 1757, 1915, 1941, 2142, 2232, ...\n 10: 1470\n\nlength(st_intersects(mpsz, preschool))\n\n[1] 323\n\nlengths(st_intersects(mpsz, preschool))\n\n  [1]  0  6  0  5  3 13  5  1 11  1  4  2  0  1  6  0  0  0  0  4  0  1  0  5  4\n [26]  1  7  2 12  7  0  0  4  0  4 10  1  3  0  6  0  3  1  0  3  0  4  1  9  0\n [51]  1  4  1  2  4  0  2  1  2  0  3  0  2  6  1  0 13  3 14  1  4  9  1  5  0\n [76]  0  3 11  0  0  1  0  3  1  2  0  0  5  0  7  3  4  0  0  7  0  0  2  0  4\n[101] 10  0 14  0  3  2  2 29 18 21  0  0  5  5  0 10 23 22  7  2  1  0  0  0  6\n[126]  6  3  0  0  8  5  5  8  6  5  5 11  9  8  0  3  8  1  0  3 24  0  7 18 11\n[151] 10 28 13  4  0  6  6  0  2  8  6  0 40  4 21  0 36 14  4 16 11 13  5  7  9\n[176] 12 30  0  0 11 13 38 11  0  8 19  5  5 72  9  0  4 32  7  3  3  9  3 38 18\n[201]  0 15  0 12  4 11 23 16  0  7 21 19  8 20 15 26  6 23 13  6  0 13  5 12 10\n[226]  7  6  7  1  8 25  3  8  0  0 18 13 10 16  9  9 17  5  1  3 22  4 12  4  9\n[251]  3  0 17 10  4  0  0  9 16 27  0 16 22 16  0 13 23  0  2  0  0 33 20  0 22\n[276]  6  8  5  6  0  0 14 21 20  1  0 22  2  0 54 27  1 10  0  0 10  0  0  0 12\n[301]  0  0  1  0 20 19  9 12  2 15  0  0  0  1  0  0  3  0  0  4  1  0  0\n\n#combine the two steps into one-line code\nmpsz$`PreSch Count` &lt;- lengths(st_intersects(mpsz, preschool))\n\n#alternatively, using tidyverse way\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Count`= lengths(st_intersects(mpsz,preschool)))\n\nNote: st_intersects() is a spatial predicate that quickly checks relationships between features and returns indices (or a list) showing which features intersect, without creating new geometries. In contrast, st_intersection() performs a full geometric overlay, generating new sf features that represent the actual overlapping geometries and carrying attributes from both input layers, which is more computationally intensive.\n\n# statistical summary for the new column\nsummary(mpsz$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n#top_n() of dplyr package to see the sub zone with the most number of pre-school\ntop_n(mpsz, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\nStep 2: The code chunk below uses st_area() from the sf package to calculate the area of each subzone, returning values in square metres because the CRS (SVY21) is in metres. Note that the SHAPE_Area field shown in the glimpse(mpsz) output is a precomputed attribute from the original dataset and may not be accurate for current analysis; we rely on st_area() instead.\n\nmpsz$AREA &lt;- mpsz %&gt;%\n  st_area()\n\nsummary(mpsz$AREA)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   39438   628261  1229894  2420882  2106483 69748299 \n\n\nThe code chunk below computes preschool density per km2 ( 1km2 = 1,000,000m2). We convert to per km2 to make the numbers comparable and readable.\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/AREA * 1000000)\n\n#quick overview of the stats for the new column\nsummary(mpsz$`PreSch Density`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nStep 3: EDA using ggplot2\n\nUse hist() of R Graphics to plot a histogram of the distribution of PreSch Density.\n\n\nhist(mpsz$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nuse ggplot2 functions to provide informative visualisation.\n\nb1. create a histogram\n\n#initiates the ggplot using mpsz data fram, set x-axis\nggplot(data=mpsz,\n       aes(x = as.numeric(`PreSch Density`))) +\n  #adds a histogram layer, with bin numbers, colour and fill colour\n  geom_histogram(bins = 20,\n                 color = \"black\",\n                 fill = \"lightblue\") + \n  #adds labels such as title, subtitle, and for x, y axis\n  labs(title = \"Are pre-school evenly distrubted in Singapore?\",\n      subtitle = \"There are many planning subzones with a single pre-school, on the other hand,\\nthere are seven planning subzones with at least 30 or more pre-schools.\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\n\n\n\nb2. create a scatterplot for PreSch Density and PreSch Count.\n\n#starts a ggplot with mpsz, and maps x to PreSch Density and y to PreSch Count.\n#Uses as.numeric() to drop units from PreSch Density and coerce it to plain numbers\nggplot(data=mpsz,\n       aes(y = `PreSch Count`,\n           x = as.numeric(`PreSch Density`))) +\n  #adds points and colours\n  geom_point(shape =21,\n             color =\"black\",\n             fill = \"lightblue\") +\n  #sets the range of data from 0 to 40.\n  xlim(0,40) +\n  ylim(0,40) + \n  #adds labels\n  labs(title =\"\",\n       x = \"Pre-school density (per km sq)\",\n       y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nThe End."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#ex2-thematic-mapping-and-geovisualisation-with-r",
    "href": "Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html#ex2-thematic-mapping-and-geovisualisation-with-r",
    "title": "Hands-on Exercise 02",
    "section": "",
    "text": "Thematic mapping: using map symbols to visualise geographic features.\nGeovisualisation: the combination of cartography, computer science, and visualisation to enhance spatial understanding and support knowledge discovery.\n\n\nPackages used:\ntmap: for plotting choropleth maps\nreadr: for importing CSV files (tidyverse)\ntidyr: for tidying data (tidyverse)\ndplyr: for wrangling data (tidyverse)\nsf: for processing geospatial vector data\nrvest: for scraping data from web pages\nHere we load the required packages into R environment.if they are not installed, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tmap,tidyverse,rvest)\n\n\n\n\nGeospatial data is Master Plan 2019 Subzone Boundary (No Sea) (KML) downloaded from data.gov.sg.\nAspatial data is Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2024 in csv format from DOS.\n\n\nThe code chunk below use st_read() function from sf package to import Geospatial data: Master Plan 2019 Subzone Boundary (No Sea) (KML).\n\nmpsz &lt;- st_read(\"data/geospatial/MasterPlan2019SubzoneBoundaryNoSeaKML.kml\")\n\nReading layer `URA_MP19_SUBZONE_NO_SEA_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex02\\data\\geospatial\\MasterPlan2019SubzoneBoundaryNoSeaKML.kml' \n  using driver `KML'\nSimple feature collection with 332 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n2.3.2.1 Tidying Data\n\n#quick overview of the subzone data\nst_geometry(mpsz)\n\nGeometry set for 332 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((103.8145 1.282387, 103.8177 1.2...\n\n\nMULTIPOLYGON (((103.8221 1.280494, 103.8221 1.2...\n\n\nMULTIPOLYGON (((103.8438 1.285079, 103.844 1.28...\n\n\nMULTIPOLYGON (((103.8496 1.284119, 103.8496 1.2...\n\n\nMULTIPOLYGON (((103.8525 1.286166, 103.8525 1.2...\n\nglimpse(mpsz)\n\nRows: 332\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((103.8145 1...., MULTIPOLYGON …\n\nmpsz$Description[1:10] \n\n [1] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;DEPOT ROAD&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;C22DED671DE2A940&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"        \n [2] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;2&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ02&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;085EF219A5A1AEAD&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"        \n [3] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;3&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;CHINATOWN&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;OTSZ03&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;OUTRAM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;OT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;EF2B9A91AF49E025&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"               \n [4] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;PHILLIP&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ04&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;615D4EDDEF809F8E&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"          \n [5] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;5&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;RAFFLES PLACE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ05&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;72107B11807074F4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"    \n [6] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;CHINA SQUARE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;OTSZ04&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;OUTRAM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;OT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;B609DF5587626C8F&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"            \n [7] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;10&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;TIONG BAHRU&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ10&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;A0FB4B68155D164A&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"       \n [8] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;BAYFRONT SUBZONE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ12&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;197F5E664DA4D5E1&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"\n [9] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;4&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;TIONG BAHRU STATION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;BMSZ04&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;N&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;BUKIT MERAH&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;BM&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;91FFE927ABE3E4DB&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"\n[10] \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_NO&lt;/th&gt;\\n&lt;td&gt;6&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;SUBZONE_N&lt;/th&gt;\\n&lt;td&gt;CLIFFORD PIER&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;SUBZONE_C&lt;/th&gt;\\n&lt;td&gt;DTSZ06&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;CA_IND&lt;/th&gt;\\n&lt;td&gt;Y&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;PLN_AREA_N&lt;/th&gt;\\n&lt;td&gt;DOWNTOWN CORE&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;PLN_AREA_C&lt;/th&gt;\\n&lt;td&gt;DT&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;REGION_N&lt;/th&gt;\\n&lt;td&gt;CENTRAL REGION&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;REGION_C&lt;/th&gt;\\n&lt;td&gt;CR&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"#E3E3F3\\\"&gt;\\n&lt;th&gt;INC_CRC&lt;/th&gt;\\n&lt;td&gt;945CC212CA80626F&lt;/td&gt;\\n&lt;/tr&gt;&lt;tr bgcolor=\\\"\\\"&gt;\\n&lt;th&gt;FMEL_UPD_D&lt;/th&gt;\\n&lt;td&gt;20191223152313&lt;/td&gt;\\n&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\"    \n\n#first 10: each has a small table of key–value rows like SUBZONE_N:DEPOT ROAD, REGION_N:CENTRAL REGION, etc.\n\nThe code chunk below create function extract_kml_field to extract values from the HTML description.\n\nextract_kml_field &lt;- function(html_text, field_name) {\n  # return NA if missing or empty\n  if (is.na(html_text) || html_text == \"\") return(NA_character_)\n  \n  page &lt;- read_html(html_text)          #parse the HTML string \n  rows &lt;- page %&gt;% html_elements(\"tr\")  #get all table rows &lt;tr&gt;\n  \n  value &lt;- rows %&gt;%\n    keep(~ html_text2(html_element(.x, \"th\")) == field_name) %&gt;% #keep row where &lt;th&gt; table header text = field_name\n    html_element(\"td\") %&gt;%                                       #take its &lt;td&gt; table data\n    html_text2()                                                 #extract clean text\n  \n  if (length(value) == 0) NA_character_ else value        #return NA if no match, otherwise the value\n}\n\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(\n     #for each description string, call the function, It returns a length-1 character per row (or NA)\n    REGION_N = map_chr(Description, extract_kml_field, \"REGION_N\"),\n    PLN_AREA_N = map_chr(Description, extract_kml_field, \"PLN_AREA_N\"),\n    SUBZONE_N = map_chr(Description, extract_kml_field, \"SUBZONE_N\"),\n    SUBZONE_C = map_chr(Description, extract_kml_field, \"SUBZONE_C\")\n  ) %&gt;%\n  select(-Name, -Description) %&gt;% #drop the raw KML attributes\n  relocate(geometry, .after = last_col()) #move the geometry column to the end\n\nInterestingly, Quarto prints the object using sf’s print method. That shows a summary and then only the first 10 rows by default.\n\nmpsz\n\nSimple feature collection with 332 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 10 features:\n         REGION_N    PLN_AREA_N           SUBZONE_N SUBZONE_C\n1  CENTRAL REGION   BUKIT MERAH          DEPOT ROAD    BMSZ12\n2  CENTRAL REGION   BUKIT MERAH         BUKIT MERAH    BMSZ02\n3  CENTRAL REGION        OUTRAM           CHINATOWN    OTSZ03\n4  CENTRAL REGION DOWNTOWN CORE             PHILLIP    DTSZ04\n5  CENTRAL REGION DOWNTOWN CORE       RAFFLES PLACE    DTSZ05\n6  CENTRAL REGION        OUTRAM        CHINA SQUARE    OTSZ04\n7  CENTRAL REGION   BUKIT MERAH         TIONG BAHRU    BMSZ10\n8  CENTRAL REGION DOWNTOWN CORE    BAYFRONT SUBZONE    DTSZ12\n9  CENTRAL REGION   BUKIT MERAH TIONG BAHRU STATION    BMSZ04\n10 CENTRAL REGION DOWNTOWN CORE       CLIFFORD PIER    DTSZ06\n                         geometry\n1  MULTIPOLYGON (((103.8145 1....\n2  MULTIPOLYGON (((103.8221 1....\n3  MULTIPOLYGON (((103.8438 1....\n4  MULTIPOLYGON (((103.8496 1....\n5  MULTIPOLYGON (((103.8525 1....\n6  MULTIPOLYGON (((103.8486 1....\n7  MULTIPOLYGON (((103.8311 1....\n8  MULTIPOLYGON (((103.8589 1....\n9  MULTIPOLYGON (((103.8283 1....\n10 MULTIPOLYGON (((103.8552 1....\n\n\n\n\n\nwe use read_csv() to import the csv file as a tibble dataframe and name it popdata.\n\npopdata &lt;- read_csv(\"data/aspatial/respopagesextod2024.csv\")\n\nRows: 100928 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(popdata, 5)\n\n# A tibble: 5 × 7\n  PA         SZ                     AG     Sex   TOD                   Pop  Time\n  &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;\n1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 1- and 2-Room …     0  2024\n2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 3-Room Flats        0  2024\n3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 4-Room Flats       10  2024\n4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HDB 5-Room and Exe…    20  2024\n5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males HUDC Flats (exclud…     0  2024\n\n\n\n\n\nVariables:\nPA: Planning area.\nSZ: Subzone.\nYOUNG: Ages 0–24 (0–4, 5–9, 10–14, 15–19, 20–24).\nECONOMY_ACTIVE: Ages 25–64 (25–29 … 60–64).\nAGED: Ages 65+.\nTOTAL: Sum of all age groups.\nDEPENDENCY: (YOUNG + AGED)/ECONOMY_ACTIVE ×100 as %\n2.3.4.1 Data Wrangling\n\npopdata2024 &lt;- popdata %&gt;%\n  #aggregates population counts (Pop) for each combination of planning area (PA), subzone (SZ), and age group (AG).\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP`= sum(`Pop`)) %&gt;%\n  #reshapes the table so each age group (AG) becomes its own column, with population counts as values.\n  ungroup()%&gt;%\n  pivot_wider(names_from =AG,\n              values_from = POP) %&gt;%\n# quick preview of structure\n  {glimpse(.) ; .} %&gt;%\n  #adds new columns by summing selected age-group columns\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[12])) %&gt;%\n  mutate(`ECONOMY ACTIVE` = rowSums(.[7:11]) \n         +rowSums(.[13:15])) %&gt;%\n  mutate(`AGED` = rowSums(.[16:21])) %&gt;%\n  mutate(`TOTAL` = rowSums(.[3:21])) %&gt;%\n  mutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n         /`ECONOMY ACTIVE`) %&gt;%\n  # quick preview of structure\n  {glimpse(.) ; .} %&gt;%\n  #keeps only the useful columns.\n  select (`PA`, `SZ`,`YOUNG`,\n          `ECONOMY ACTIVE`, `AGED`,\n          `TOTAL`, `DEPENDENCY`)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\n\nRows: 332\nColumns: 21\n$ PA            &lt;chr&gt; \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", …\n$ SZ            &lt;chr&gt; \"Ang Mo Kio Town Centre\", \"Cheng San\", \"Chong Boon\", \"Ke…\n$ `0_to_4`      &lt;dbl&gt; 130, 770, 610, 570, 210, 680, 210, 490, 0, 130, 0, 650, …\n$ `10_to_14`    &lt;dbl&gt; 290, 970, 870, 840, 360, 670, 370, 820, 0, 240, 0, 1030,…\n$ `15_to_19`    &lt;dbl&gt; 300, 1070, 990, 940, 450, 780, 450, 890, 0, 250, 0, 1230…\n$ `20_to_24`    &lt;dbl&gt; 280, 1190, 1130, 1020, 440, 810, 510, 810, 0, 270, 0, 14…\n$ `25_to_29`    &lt;dbl&gt; 280, 1480, 1440, 1190, 470, 1020, 530, 1060, 0, 310, 0, …\n$ `30_to_34`    &lt;dbl&gt; 280, 1890, 1580, 1370, 410, 1230, 530, 1340, 0, 270, 0, …\n$ `35_to_39`    &lt;dbl&gt; 300, 1820, 1640, 1370, 320, 1110, 420, 1210, 0, 240, 0, …\n$ `40_to_44`    &lt;dbl&gt; 420, 2080, 1590, 1550, 410, 1090, 390, 1390, 0, 290, 0, …\n$ `45_to_49`    &lt;dbl&gt; 410, 1890, 1750, 1590, 460, 1160, 500, 1520, 0, 310, 0, …\n$ `50_to_54`    &lt;dbl&gt; 440, 2080, 1770, 1690, 550, 1250, 620, 1480, 0, 350, 0, …\n$ `55_to_59`    &lt;dbl&gt; 320, 2020, 1910, 1710, 530, 1220, 570, 1320, 0, 290, 0, …\n$ `5_to_9`      &lt;dbl&gt; 240, 950, 710, 790, 350, 750, 310, 660, 0, 200, 0, 890, …\n$ `60_to_64`    &lt;dbl&gt; 310, 2040, 2050, 1680, 480, 1410, 650, 1530, 0, 310, 0, …\n$ `65_to_69`    &lt;dbl&gt; 280, 2040, 2040, 1660, 420, 1270, 660, 1560, 0, 320, 0, …\n$ `70_to_74`    &lt;dbl&gt; 260, 1970, 1940, 1600, 390, 1170, 480, 1430, 0, 240, 0, …\n$ `75_to_79`    &lt;dbl&gt; 190, 1340, 1510, 1150, 280, 860, 310, 1140, 0, 180, 0, 1…\n$ `80_to_84`    &lt;dbl&gt; 110, 830, 960, 740, 200, 590, 220, 750, 0, 110, 0, 550, …\n$ `85_to_89`    &lt;dbl&gt; 50, 380, 520, 400, 120, 310, 140, 420, 0, 70, 0, 260, 90…\n$ `90_and_over` &lt;dbl&gt; 20, 230, 300, 230, 70, 190, 100, 230, 0, 40, 0, 160, 40,…\nRows: 332\nColumns: 26\n$ PA               &lt;chr&gt; \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio\", \"Ang Mo Kio…\n$ SZ               &lt;chr&gt; \"Ang Mo Kio Town Centre\", \"Cheng San\", \"Chong Boon\", …\n$ `0_to_4`         &lt;dbl&gt; 130, 770, 610, 570, 210, 680, 210, 490, 0, 130, 0, 65…\n$ `10_to_14`       &lt;dbl&gt; 290, 970, 870, 840, 360, 670, 370, 820, 0, 240, 0, 10…\n$ `15_to_19`       &lt;dbl&gt; 300, 1070, 990, 940, 450, 780, 450, 890, 0, 250, 0, 1…\n$ `20_to_24`       &lt;dbl&gt; 280, 1190, 1130, 1020, 440, 810, 510, 810, 0, 270, 0,…\n$ `25_to_29`       &lt;dbl&gt; 280, 1480, 1440, 1190, 470, 1020, 530, 1060, 0, 310, …\n$ `30_to_34`       &lt;dbl&gt; 280, 1890, 1580, 1370, 410, 1230, 530, 1340, 0, 270, …\n$ `35_to_39`       &lt;dbl&gt; 300, 1820, 1640, 1370, 320, 1110, 420, 1210, 0, 240, …\n$ `40_to_44`       &lt;dbl&gt; 420, 2080, 1590, 1550, 410, 1090, 390, 1390, 0, 290, …\n$ `45_to_49`       &lt;dbl&gt; 410, 1890, 1750, 1590, 460, 1160, 500, 1520, 0, 310, …\n$ `50_to_54`       &lt;dbl&gt; 440, 2080, 1770, 1690, 550, 1250, 620, 1480, 0, 350, …\n$ `55_to_59`       &lt;dbl&gt; 320, 2020, 1910, 1710, 530, 1220, 570, 1320, 0, 290, …\n$ `5_to_9`         &lt;dbl&gt; 240, 950, 710, 790, 350, 750, 310, 660, 0, 200, 0, 89…\n$ `60_to_64`       &lt;dbl&gt; 310, 2040, 2050, 1680, 480, 1410, 650, 1530, 0, 310, …\n$ `65_to_69`       &lt;dbl&gt; 280, 2040, 2040, 1660, 420, 1270, 660, 1560, 0, 320, …\n$ `70_to_74`       &lt;dbl&gt; 260, 1970, 1940, 1600, 390, 1170, 480, 1430, 0, 240, …\n$ `75_to_79`       &lt;dbl&gt; 190, 1340, 1510, 1150, 280, 860, 310, 1140, 0, 180, 0…\n$ `80_to_84`       &lt;dbl&gt; 110, 830, 960, 740, 200, 590, 220, 750, 0, 110, 0, 55…\n$ `85_to_89`       &lt;dbl&gt; 50, 380, 520, 400, 120, 310, 140, 420, 0, 70, 0, 260,…\n$ `90_and_over`    &lt;dbl&gt; 20, 230, 300, 230, 70, 190, 100, 230, 0, 40, 0, 160, …\n$ YOUNG            &lt;dbl&gt; 1440, 6080, 5370, 5060, 2010, 4190, 2160, 4490, 0, 12…\n$ `ECONOMY ACTIVE` &lt;dbl&gt; 2560, 14170, 12670, 11250, 3430, 8990, 3900, 10030, 0…\n$ AGED             &lt;dbl&gt; 910, 6790, 7270, 5780, 1480, 4390, 1910, 5530, 0, 960…\n$ TOTAL            &lt;dbl&gt; 4910, 27040, 25310, 22090, 6920, 17570, 7970, 20050, …\n$ DEPENDENCY       &lt;dbl&gt; 0.9179688, 0.9082569, 0.9976322, 0.9635556, 1.0174927…\n\n\n2.3.4.2 Joining the attribute data and geospatial data\n\npopdata2024 &lt;- popdata2024 %&gt;%\n  #converts PA and SZ names to uppercase so they will match the geospatial dataset’s fields (SUBZONE_N and PLN_AREA_N are uppercase).\n  mutate_at(.vars = vars(PA, SZ),\n            .funs = list(toupper)) %&gt;%\n  filter(`ECONOMY ACTIVE` &gt; 0)\n# quick preview of structure\nglimpse(popdata2024)\n\nRows: 238\nColumns: 7\n$ PA               &lt;chr&gt; \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO…\n$ SZ               &lt;chr&gt; \"ANG MO KIO TOWN CENTRE\", \"CHENG SAN\", \"CHONG BOON\", …\n$ YOUNG            &lt;dbl&gt; 1440, 6080, 5370, 5060, 2010, 4190, 2160, 4490, 1240,…\n$ `ECONOMY ACTIVE` &lt;dbl&gt; 2560, 14170, 12670, 11250, 3430, 8990, 3900, 10030, 2…\n$ AGED             &lt;dbl&gt; 910, 6790, 7270, 5780, 1480, 4390, 1910, 5530, 960, 5…\n$ TOTAL            &lt;dbl&gt; 4910, 27040, 25310, 22090, 6920, 17570, 7970, 20050, …\n$ DEPENDENCY       &lt;dbl&gt; 0.9179688, 0.9082569, 0.9976322, 0.9635556, 1.0174927…\n\n\nThe ECONOMY_ACTIVE column has back ticks, which is because of R’s display convention.\n\n#joins the attribute table (popdata2024) with the polygon map (mpsz) using subzone name as the key: SUBZONE_N from the map, SZ from the population data.\nmpsz_pop2024 &lt;- left_join(mpsz, popdata2024,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\nglimpse(mpsz_pop2024)\n\nRows: 332\nColumns: 11\n$ REGION_N         &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\",…\n$ PLN_AREA_N       &lt;chr&gt; \"BUKIT MERAH\", \"BUKIT MERAH\", \"OUTRAM\", \"DOWNTOWN COR…\n$ SUBZONE_N        &lt;chr&gt; \"DEPOT ROAD\", \"BUKIT MERAH\", \"CHINATOWN\", \"PHILLIP\", …\n$ SUBZONE_C        &lt;chr&gt; \"BMSZ12\", \"BMSZ02\", \"OTSZ03\", \"DTSZ04\", \"DTSZ05\", \"OT…\n$ PA               &lt;chr&gt; \"BUKIT MERAH\", \"BUKIT MERAH\", \"OUTRAM\", NA, NA, \"OUTR…\n$ YOUNG            &lt;dbl&gt; 1820, 260, 2410, NA, NA, 190, 2820, NA, 3720, NA, NA,…\n$ `ECONOMY ACTIVE` &lt;dbl&gt; 3550, 460, 5440, NA, NA, 560, 6710, NA, 7800, NA, NA,…\n$ AGED             &lt;dbl&gt; 1180, 260, 2270, NA, NA, 460, 2680, NA, 3130, NA, NA,…\n$ TOTAL            &lt;dbl&gt; 6550, 980, 10120, NA, NA, 1210, 12210, NA, 14650, NA,…\n$ DEPENDENCY       &lt;dbl&gt; 0.8450704, 1.1304348, 0.8602941, NA, NA, 1.1607143, 0…\n$ geometry         &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((103.8145 1...., MULTIPOL…\n\n\n\n#Saves the combined sf object as an .rds file, which can be reloaded later with read_rds()\nwrite_rds(mpsz_pop2024,\"data/rds/mpsz_pop2024.rds\")\n\n\n\n\n\nChoropleth mapping shows data by colouring areas such as countries, states, or census zones, using shades or patterns to represent values.\n\n\nqtm(): stands for Quick Thematic Map to plot quick, simple maps.\n\ntmap_mode(\"plot\")         #plot: static; view: interactive\n\nℹ tmap mode set to \"plot\".\n\nqtm(shp = mpsz_pop2024,\n    fill = \"DEPENDENCY\")   #attribute/column\n\n\n\n\n\n\n\n\n\n\n\ntmap elements: for detailed, highly customisable maps.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"brewer.blues\"),\n              fill.legend = tm_legend(\n                title = \"Dependency ratio\")) +\n  tm_title(\"Distribution of Dependency Ratio by Planning Subzone\") +\n  tm_layout(frame = TRUE) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scalebar() +\n  tm_grid(alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone Boundary from Urban Redevelopment Authority (URA)\\n and Popluation Data from Department of Statistics DOS\",\n             position = c(\"left\",\"bottom\"),\n             just = c(\"left\",\"bottom\"),\n             outside = TRUE)\n\n[plot mode] fit legend/component: Some legend items or map compoments do not\nfit well, and are therefore rescaled.\nℹ Set the tmap option `component.autoscale = FALSE` to disable rescaling.\n\n\n\n\n\n\n\n\n\n2.4.2.1 Drawing a base map using tm_shape().\nBy default, tmap draws polygons with a dark gray outline (gray25) and a light gray fill (gray85).\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons()\n\n\n\n\n\n\n\n\n2.4.2.2 Drawing a choropleth map using tm_polygons()\nHere is a summary of the key points of tm_polygons() defaults:\nClassification: uses the “pretty” interval method.\nColour scheme: defaults to ColorBrewer’s Blues3 palette.\nMissing values: shown in grey.\n\ntm_shape(mpsz_pop2024)+\n  tm_polygons(fill = \"DEPENDENCY\")\n\n\n\n\n\n\n\n\n2.4.2.3 Drawing a choropleth map using tm_fill() and tm_borders()\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(\"DEPENDENCY\")\n\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(\"DEPENDENCY\") +\n  tm_borders()\n\n\n\n\n\n\n\n\nBorders in tm_borders(): by default, polygons are outlined in light gray.\nfill_alpha: controls polygon transparency (0 = invisible, 1 = fully opaque).\nOther key arguments:\ncol: border colour\nlwd: border line width (default = 1, thin line)\nlty: border line type (default = “solid”, others like dashed, dotted)\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(\"DEPENDENCY\") +\n  tm_borders(col = \"grey60\",\n             lwd = 0.1,\n             lty = \"dashed\")\n\n\n\n\n\n\n\n\n\n\n\ntmap supports ten data classification methods for choropleth mapping: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\n2.4.3.1 Plotting choropleth maps with built-in classification methods\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\nQuantile (above) shows differences more clearly, while Equal interval is better for showing absolute value ranges but may hide variation if data are skewed.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"equal\",\n                n = 5)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\nDIY 1: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"sd\",\n                n = 5)) +\n    tm_borders(fill_alpha = 0.5)  \n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"jenks\",\n                n = 5)) +\n    tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"bclust\",\n                n = 5)) +\n    tm_borders(fill_alpha = 0.5)\n\nCommittee Member: 1(1) 2(1) 3(1) 4(1) 5(1) 6(1) 7(1) 8(1) 9(1) 10(1)\nComputing Hierarchical Clustering\n\n\n\n\n\n\n\n\n\nDIY 2:\nUsing different class numbers changes map readability. Fewer classes (2–3) give a simple overview but hide variation. Moderate classes (5–7) balance detail and clarity. More classes (10–20) seem similar to 5-7 classes overall but too many classes could reduce clarity. So 5–7 classes are best for clear and insightful choropleth maps.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 2)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 6)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 10)) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 20)) +\n  tm_borders(fill_alpha = 0.5)\n\n[plot mode] fit legend/component: Some legend items or map compoments do not\nfit well, and are therefore rescaled.\nℹ Set the tmap option `component.autoscale = FALSE` to disable rescaling.\n\n\n\n\n\n\n\n\n\n2.4.3.2 Plotting Choropleth map with custom break\n\nsummary(mpsz_pop2024$DEPENDENCY)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.1905  0.7450  0.8377  0.8738  0.9366 12.7500      94 \n\n\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00))) +\n  tm_borders(fill_alpha = 0.5)\n\nWarning: Values have found that are higher than the highest break. They are\nassigned to the highest interval\n\n\n\n\n\n\n\n\n\n\n\n\n2.4.4.1 Using ColourBrewer palette\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"brewer.greens\")) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\nUsing “-” to reverse the colour shading.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"-brewer.greens\")) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\n2.4.4.2 Cartographic Furniture\nThe code chunk below uses tm_compass(), tm_scale_bar(), tm_grid() and tm_credit() to draw cartographic furniture like compass, scale bar, grid lines.\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5)) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_compass(type = \"8star\", size = 2) +\n  tm_scalebar() +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: data.gov.sg & Singstat\",\n            position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\n\n\n\n\n\n2.4.5.1 Map Legend\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5),\n              fill.legend = tm_legend(\n                title = \"Dependency ratio\")) +\n  tm_pos_auto_in() +\n  tm_borders(fill_alpha = 0.5) +\n  tm_compass(type =\"8star\", size = 2) +\n  tm_scalebar() +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: data.gov.sg & singstat\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\n\n2.4.5.2 Map style\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"-brewer.greens\")) + \n  tm_borders(fill_alpha = 0.5) + \n  tmap_style(\"natural\")\n\nstyle set to \"natural\"\n\n\nother available styles are: \"white\" (tmap default), \"gray\", \"cobalt\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\"\n\n\ntmap v3 styles: \"v3\" (tmap v3 default), \"gray_v3\", \"natural_v3\", \"cobalt_v3\", \"albatross_v3\", \"beaver_v3\", \"bw_v3\", \"classic_v3\", \"watercolor_v3\"\n\n\n\n\n\n\n\n\n\n\n#reset to default style; options: white (default), gray, natural, classic, cobalt, albatross, beaver, and bw (black & white).\n\ntm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                n = 5,\n                values = \"-brewer.greens\")) + \n  tm_borders(fill_alpha = 0.5) + \n  tmap_style(\"white\")\n\nstyle set to \"white\" (tmap default)\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\"\n\n\ntmap v3 styles: \"v3\" (tmap v3 default), \"gray_v3\", \"natural_v3\", \"cobalt_v3\", \"albatross_v3\", \"beaver_v3\", \"bw_v3\", \"classic_v3\", \"watercolor_v3\"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhy my maps are arranged vertically but the ones in example are shown horizontally?\n\n# assigning two variables to the visual variable (fill)\ntm_shape(mpsz_pop2024) + \n  tm_polygons(\n    fill = c(\"YOUNG\", \"AGED\"),\n    fill.legend = \n      tm_legend(position = tm_pos_in(\n        \"right\", \"bottom\")),\n    fill.scale = tm_scale_intervals(\n      style = \"equal\", \n      n = 5,\n      values = \"brewer.blues\")) +\n  tm_borders(fill_alpha = 0.5) +\n  tmap_style(\"natural\")\n\nstyle set to \"natural\"\n\n\nother available styles are: \"white\" (tmap default), \"gray\", \"cobalt\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\"\n\n\ntmap v3 styles: \"v3\" (tmap v3 default), \"gray_v3\", \"natural_v3\", \"cobalt_v3\", \"albatross_v3\", \"beaver_v3\", \"bw_v3\", \"classic_v3\", \"watercolor_v3\"\n\n\n\n\n\n\n\n\n\n\n\n\nIn tmap_arrange(), asp controls the panel aspect ratio (height ÷ width): asp = 1 makes panels square, asp &gt; 1 makes them taller than wide, asp &lt; 1 makes them wider than tall, and asp = 0 allows free stretching. The ncol argument sets how many maps are placed per row.\n\nyoungmap &lt;- tm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"YOUNG\",\n              fill.legend = tm_legend(\n                position = tm_pos_in(\n                  \"right\", \"bottom\"),\n                item.height = 0.8),\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.blues\")) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"Distribution of young population\")\n\nagedmap &lt;- tm_shape(mpsz_pop2024) +\n  tm_polygons(fill = \"AGED\",\n              fill.legend = tm_legend(\n                position = tm_pos_in(\n                  \"right\", \"bottom\"),\n                item.height = 0.8),\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.blues\")) +\n  tm_borders(fill_alpha = 0.5) +\n  tm_title(\"Distribution of young population\")\n\ntmap_arrange(youngmap, agedmap, asp = 1, ncol = 2)\n\n\n\n\n\n\n\n\n\n\n\nThe code below uses tm_facets() to split the map into facets by region name, arranged in 2 rows × 3 columns; each facet has its own coordinate system (free.coords), and subzones not in that facet are dropped (drop.units).\nIn R, c() stands for combine. It creates a vector by combining multiple values into one object.\n\ntm_shape(mpsz_pop2024) +\n  tm_fill(fill = \"DEPENDENCY\",\n          fill.scale = tm_scale_intervals(\n            style = \"quantile\",\n            values = \"brewer.blues\")) + \n  tm_facets(by = \"REGION_N\",\n            nrow = 2, \n            ncols = 3,\n            free.coords=TRUE, \n            drop.units=TRUE) +\n  tm_layout(legend.show = TRUE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\n\n\nmpsz_pop2024 %&gt;%\n  filter(REGION_N == \"CENTRAL REGION\") %&gt;%\n  tm_shape() +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.greens\"),\n              fill.legend = tm_legend()) +\n  tm_borders(fill_alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\n\nLegend charts are small charts that are added to the map, usually in addition to legends. Arguments that could be assigned to fill.chart are tm_chart_histogram(), tm_chart_bar(), tm_chart_donut(),tm_chart_violin(), tm_chart_box(), tm_chart_none(),tm_chart_heatmap().\n\nmpsz_pop2024 %&gt;%\n  filter(REGION_N == \"CENTRAL REGION\") %&gt;%\n  tm_shape() +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.greens\"),\n              fill.legend = tm_legend(),\n              fill.chart = tm_chart_box()) + #other options \n  tm_borders() +\n  tm_layout(asp = 0.8)\n\n\n\n\n\n\n\n\n\nmpsz_selected &lt;- mpsz_pop2024 %&gt;%\n  filter(REGION_N == \"CENTRAL REGION\")\n\nstats &lt;- boxplot.stats(mpsz_selected$DEPENDENCY)\n\noutlier_vals &lt;- stats$out #$out gives the outlier values of DEPENDENCY (those outside 1.5×IQR rule).\n\noutlier_sf &lt;- mpsz_selected[mpsz_selected$DEPENDENCY %in% outlier_vals, ]\n\ntm_shape(mpsz_selected) +\n  tm_polygons(fill = \"DEPENDENCY\",\n              fill.scale = tm_scale_intervals(\n                style = \"quantile\",\n                values = \"brewer.blues\"),\n              fill.legend = tm_legend(),\n              fill.chart = tm_chart_box()) +\n  tm_borders(fill_alpha = 0.5) +\ntm_shape(outlier_sf) +\n  tm_borders(col =\"red\", lwd = 2) +\n  tm_text(\"SUBZONE_N\", col = \"red\", size = 0.7) +\n  tm_layout(asp = 0.8)\n\n\n\n\n\n\n\n\n\n\n\nInteractive maps (tmap_mode(“view”)) let users zoom, pan, and click for details.\n\nregion_selected &lt;- mpsz_pop2024 %&gt;%\n  filter(REGION_N== \"CENTRAL REGION\")\nregion_bbox &lt;- st_bbox(region_selected)\n\nstats &lt;- boxplot.stats(region_selected$DEPENDENCY)\noutlier_vals &lt;- stats$out\noutlier_sf &lt;- region_selected[region_selected$DEPENDENCY %in% outlier_vals, ]\n\ntmap_mode(\"view\")\n\nℹ tmap mode set to \"view\".\n\ntm_shape(region_selected,\n         bbox = region_bbox) +\n  tm_fill(\"DEPENDENCY\",\n          id = \"SUBZONE_N\",\n          popup.vars = c(\n            \"Name\" = \"SUBZONE_N\",\n            \"Dependnecy\" = \"DEPENDENCY\")) +\n  tm_borders() +\n  tm_shape(outlier_sf) +\n  tm_borders(col = \"red\", lwd = 2)\n\n\n\n\n\n\nThe code chunk below adds tmap_mode(“plot”) after producing the interactive map to reset to static mode for subsequent maps.\n\ntmap_mode(\"plot\")\n\nℹ tmap mode set to \"plot\".\n\n\nTHe code chunk blow uses tm_view(set_zoom_limits = c(12,14)) to control zoom freedom and keep the view focused.\n\nregion_selected &lt;- mpsz_pop2024 %&gt;%\n  filter(REGION_N== \"CENTRAL REGION\")\nregion_bbox &lt;- st_bbox(region_selected)\n\nstats &lt;- boxplot.stats(region_selected$DEPENDENCY)\noutlier_vals &lt;- stats$out\noutlier_sf &lt;- region_selected[region_selected$DEPENDENCY %in% outlier_vals, ]\n\ntmap_mode(\"view\")\n\nℹ tmap mode set to \"view\".\n\ntm_shape(region_selected,\n         bbox = region_bbox) +\n  tm_fill(\"DEPENDENCY\",\n          id = \"SUBZONE_N\",\n          popup.vars = c(\n            \"Name\" = \"SUBZONE_N\",\n            \"Dependnecy\" = \"DEPENDENCY\")) +\n  tm_borders() +\n  tm_shape(outlier_sf) +\n  tm_borders(col = \"red\", lwd = 2) +\n  tm_view(set_zoom_limits = c(12,14))\n\n\n\n\n\n\n\n#reset to static maps\ntmap_mode(\"plot\")\n\nℹ tmap mode set to \"plot\".\n\n\nThe end."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01_1/Hands-on_Ex01_1.html",
    "href": "Hands-on_Ex/Hands-on_Ex01_1/Hands-on_Ex01_1.html",
    "title": "Hands-on Exercise 01-1",
    "section": "",
    "text": "The following code chunk uses the p_load() function from the pacman package to check whether the sf and tidyverse packages are installed. If they are, it loads them into the R session; if not, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tidyverse)\n\n\n\n\nThe geospatial datasets include shapefiles and KML file. (The reason of selecting file format). The geospatial data consist of the Master Plan 2014 Subzone Boundary (Web), Pre-Schools Location from data.gov.sg, and Cycling Path from LTA DataMall. The aspatial dataset is the Singapore Airbnb listings from Inside Airbnb.\nR itself is case-sensitive, especially for object and function names. Whether file paths are case-sensitive depends on the operating system, e.g. On Windows: it is not case-sensitive.\n\n1.4.1 The code below uses the st_read() function from the sf package to load the Master Plan 2014 Subzone Boundary (Web) shapefile as a polygon data frame. For shapefiles, the .shp extension does not need to be specified in the code. Both absolute and relative paths can be used, but a relative path is applied here to keep the code cleaner and shorter.\n\n\nmpsz = st_read(dsn = \"data/geospatial\",\n               layer = \"mp14_SUBZONE_WEB_PL\")\n\nReading layer `mp14_SUBZONE_WEB_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01_1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n1.4.2 Similarly, the code below uses st_read() to import the Pre-Schools Location shapefile as a polyline data frame.\n\n\ncyclingpath = st_read(dsn = \"data/geospatial\",\n                      layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01_1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4651 features and 19 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\n\n1.4.3 The code below uses st_read() to import the Pre-Schools Location in KML format as point feature data frame into R. When importing a KML file, the .kml extension must be included.\n\nsvy21 vs wgs84?\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01_1\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\n\n\nBoth two code chunks display the basic information about the dataset. However, it is more common to use the second approach.\n\nmpsz$geom\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\nst_geometry(mpsz)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nAlthough it is mentioned as one of the ways to retrieve the first 5 records like the two code chunks above, but here we see seems to be ID column?\n\nmpsz[[1]]\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108\n[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126\n[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144\n[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162\n[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180\n[181] 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198\n[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216\n[217] 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234\n[235] 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252\n[253] 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270\n[271] 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288\n[289] 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306\n[307] 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323\n\n\nFurthermore, the code below uses glimpse() of dplyr to display more detailed attribute information in the data frame.\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nLastly, the code below uses the head() function from base R (similar to Python, where the argument n can be set manually) to display the first few rows of the data frame for a quick overview.\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n\n\n\n\n\nVisualising an sf data frame is straightforward: using the plot() of Base R function automatically generates small coloured maps of the geometries by each attribute (field), while excluding non-informative columns such as the OBJECTID.\n\nplot(mpsz)\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\nMeanwhile, the code chunk below can be used to display the silhouette of the map:\n\nplot(st_geometry(mpsz))\n\n\n\n\n\n\n\n\nWe can also focus on a specific attribute by using the code chunk below:\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\n\n\nTo get a polished view of the data, we can use the tmap package, but it takes longer processing time:\n\n#library(tmap)\n#tm_shape(mpsz) +\n  #tm_fill(\"PLN_AREA_N\")+\n  #tm_borders()\n\n## comment out to save time\n\nBelow we quickly plot the preschool and cyclingpath.\n\nplot(st_geometry(preschool))\n\n\n\n\n\n\n\nplot(st_geometry(cyclingpath))\n\n\n\n\n\n\n\n\nBelow we can plot the cyclingpath layer on the top of the mpsz layer by using add argument.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(cyclingpath),\n     add = TRUE, col = \"Blue\")\n\n\n\n\n\n\n\n\nWhen trying the code with preschool, the preschool points does not appear on the subzone map because the two layers use different CRSs (mpsz in SVY21 and preschool in WGS84), transformation of preschool into the same CRS as mpsz is required before plotting the aligned map.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool),\n     add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nst_crs(preschool)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\nst_crs(cyclingpath)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nThe above funtion st_crs() reveals that the layers of mpsz and cyclingpath are indeed in SVY21, but they are missing the correct EPSG code (3414). Assigning EPSG 3414 by using st_set_crs() of sf packages ensures the CRS is properly identified, as below:\n\nmpsz &lt;- st_set_crs(mpsz,3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nOn the other hand, the code below using st_transform() reprojects the preschool data from the WGS84 to SVY21.\n\npreschool &lt;- st_transform(preschool,\n                          crs = 3414)\n\nBy display the preview of preschool sf data, we can confirm its CRS is SVY21 now.\n\nst_geometry(preschool)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)\n\n\nHere we could align both data together by setting add argument TRUE.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool), add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n1.8.1 The chunk below first uses read_csv() from readr to import listing.csv into R as a tibble data frame, and then applies list() from base R to preview the first 10 records, similar to glimpse() of dplyr.\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\n\nRows: 3659 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nlist(listings)\n\n[[1]]\n# A tibble: 3,659 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Ensuite …  367042 Belinda   East Region         Tampines          1.35\n 2  71896 B&B  Roo…  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Room 2-n…  367042 Belinda   East Region         Tampines          1.35\n 4 275343 10min wa… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 15 mins … 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 294281 5 mins w… 1521514 Elizabeth Central Region      Newton            1.31\n 7 324945 Comforta… 1439258 Kay       Central Region      Bukit Merah       1.29\n 8 330095 Relaxing… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 344803 Budget s…  367042 Belinda   East Region         Tampines          1.35\n10 369141 5mins fr… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,649 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n1.8.2 The code chunk below uses st_as_sf() of sf package to convert the listings data frame into a simple feature data frame. Specifically the coordinates are first defined in WGS84 (EPSG:4326, longitude/latitude in degrees) and then reprojected into Singapore’s SVY21 system (EPSG:3414, X/Y in metres).\n\nlistings_sf &lt;- st_as_sf(listings,\n                        coords = c(\"longitude\", \"latitude\"),\n                        crs = 4326) %&gt;% #used to nest st_transform() \n  st_transform(crs = 3414)\n\n\nglimpse(listings_sf)\n\nRows: 3,659\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 29…\n$ name                           &lt;chr&gt; \"Ensuite Room (Room 1 & 2) near EXPO\", …\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 143, NA, 76, NA, NA, 85, NA, NA, 41, 79…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 180, 180, 92, 180, 180, 92,…\n$ number_of_reviews              &lt;dbl&gt; 19, 24, 46, 20, 16, 131, 17, 5, 60, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0.10, 0.80, 0.1…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 58, 5, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 90, 79, 90, 153, 153, 365, 153, 153, 36…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, \"S039…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…\n\n\nDIY: the code chuck below plots listings_sf onto mpsz layer. The map looks better when ploting mpsz first and then listings_sf, because the polygons give context (the “base map”), and the points can be layered on top without being hidden. Thus better order is polygons first, points later.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(listings_sf), add = TRUE)\n\n\n\n\n\n\n\n\n\n#plot(st_geometry(listings_sf))\n#plot(st_geometry(mpsz), add = TRUE)\n\n\n\n\n\n\nTask: compute the total land area to reserve for a 5-m corridor/shoulder on both sides of the cycling paths.\n&lt;- assignment (always use this for storing values/importing data).\n= function arguments (inside function calls).\nSolution:\nStep 1: st_buffer() of sf package: 5-metre buffers of reserved land on both sides of existing cycling path.\n\n# quick review of the geometry type\nst_geometry_type(cyclingpath, by_geometry = FALSE)\n\n[1] MULTILINESTRING\n18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE\n\n\n\n# quick overview of the cycling path data\nglimpse(cyclingpath)\n\nRows: 4,651\nColumns: 20\n$ PATH_TYPE  &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ LVL_NUM    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ AGENCY_IMP &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ AGENCY_MAI &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ GAZETTE_DA &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ LAUNCH_DAT &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ MISC       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PKG_REF    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ AGENCY_M_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ AGENCY_I_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ LVL_NUM_DE &lt;chr&gt; \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\",…\n$ PATH_TYPE_ &lt;chr&gt; \"Shared Path\", \"Shared Path\", \"Shared Path\", \"Shared Path\",…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\n\nbuffer_cycling &lt;- st_buffer(\n  cyclingpath, dist=5, nQuadSegs = 30)\n\n#st_buffer()builds polygons at a fixed offset from a geometry.\n#cyclingpath is input, multilinestrings layer\n#dist=5, buffer distance in the layer's units. \n#Here CRS is SVY221 in metre, thus no transformation is required.\n#nQuadSegs = 30, higher the value, smoother the curve in the buffer around corners or ends.\n#stands for “number of line segments to use to approximate a quarter circle\".\n\nStep 2: use st_area() to calculate each area of the buffers\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n#st_area() returns area of each feature in the geometry column\n# units vector (m^2)\n#buffer_cycling$AREA adds a new attribute column AREA\n\nAlternatively, code uses tidyverse\n\nbuffer_cycling &lt;- buffer_cycling %&gt;%\n  mutate(AREA = st_area(geometry))\n# mutate() of dplyr, just like the $AREA, creates a new column AREA\n#geometry is the sf geometry column; st_area(geometry) computes area for each row.\n\nStep 3: sum() of Base R to add up all AREA values.\nWhat if the areas are overlapped?\n\nsum(buffer_cycling$AREA)\n\n3561648 [m^2]\n\n\nStep 4: plotting the buffer by a selected planning subzone: Tampines West\n\nfilter() of dplyr package to select the subzone\n\n\n#quick overview of the mpsz\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\nmpsz_selected &lt;- mpsz %&gt;%\n  filter(SUBZONE_N == \"TAMPINES WEST\")\n#quick overview of the newly selected subzone\nst_geometry(mpsz_selected)\n\nGeometry set for 1 feature \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 38199.84 ymin: 35355.22 xmax: 40642.12 ymax: 38054.52\nProjected CRS: SVY21 / Singapore TM\n\n\nMULTIPOLYGON (((39918.43 35362.32, 39909.84 353...\n\n#creating a plot for the subzone in general\nplot(st_geometry(mpsz_selected))\n\n\n\n\n\n\n\n\n\nst_intersection() of sf package to clip clycing buffers within the subzone. Both layers are in the SVY21. However, since EPSG code is missing in buffer_cycling, we need to assign the code 3414 to it before performing intersection.\n\n\n# checking features of the two layers\nst_crs(buffer_cycling)$epsg\n\n[1] NA\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\nst_crs(mpsz_selected)$epsg\n\n[1] 3414\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\n# EPSG assignment, or use 3414 as second parameter\nbuffer_cycling &lt;- st_set_crs(buffer_cycling, st_crs(mpsz_selected))\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\n\n\nbuffer_cycling_selected &lt;- st_intersection(\n  buffer_cycling, mpsz_selected)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n#st_intersection(x, y) returns a new sf object = overlapping parts of x and y\n\n\nplot() to create the plot\n\n\nplot(st_geometry(buffer_cycling_selected))\n\n\n\n\n\n\n\n\nDONE!\n\n\n\nSolution:\nStep 1: Use st_intersects() from the sf package to identify pre-schools located inside each subzone. Then, use the length() function from base R to calculate the number of pre-school points within each subzone. The function st_intersects() returns a list of intersections. While length() returns only the total number of subzones, the lengths() function works on a list and returns a vector with the length of each element.\n\n#perform an overview of both data frames first\nglimpse(preschool)\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [m]&gt; POINT Z (25089.46 31299.16 0), POINT Z (27189.07 327…\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n#show the outputs individually\nst_intersects(mpsz, preschool)\n\nSparse geometry binary predicate list of length 323, where the\npredicate was `intersects'\nfirst 10 elements:\n 1: (empty)\n 2: 764, 1258, 1503, 1562, 1670, 2035\n 3: (empty)\n 4: 151, 748, 1140, 1844, 2209\n 5: 190, 1496, 1924\n 6: 237, 238, 260, 264, 283, 292, 391, 714, 949, 1494, ...\n 7: 766, 1088, 1254, 1867, 2021\n 8: 498\n 9: 363, 399, 642, 1696, 1734, 1757, 1915, 1941, 2142, 2232, ...\n 10: 1470\n\nlength(st_intersects(mpsz, preschool))\n\n[1] 323\n\nlengths(st_intersects(mpsz, preschool))\n\n  [1]  0  6  0  5  3 13  5  1 11  1  4  2  0  1  6  0  0  0  0  4  0  1  0  5  4\n [26]  1  7  2 12  7  0  0  4  0  4 10  1  3  0  6  0  3  1  0  3  0  4  1  9  0\n [51]  1  4  1  2  4  0  2  1  2  0  3  0  2  6  1  0 13  3 14  1  4  9  1  5  0\n [76]  0  3 11  0  0  1  0  3  1  2  0  0  5  0  7  3  4  0  0  7  0  0  2  0  4\n[101] 10  0 14  0  3  2  2 29 18 21  0  0  5  5  0 10 23 22  7  2  1  0  0  0  6\n[126]  6  3  0  0  8  5  5  8  6  5  5 11  9  8  0  3  8  1  0  3 24  0  7 18 11\n[151] 10 28 13  4  0  6  6  0  2  8  6  0 40  4 21  0 36 14  4 16 11 13  5  7  9\n[176] 12 30  0  0 11 13 38 11  0  8 19  5  5 72  9  0  4 32  7  3  3  9  3 38 18\n[201]  0 15  0 12  4 11 23 16  0  7 21 19  8 20 15 26  6 23 13  6  0 13  5 12 10\n[226]  7  6  7  1  8 25  3  8  0  0 18 13 10 16  9  9 17  5  1  3 22  4 12  4  9\n[251]  3  0 17 10  4  0  0  9 16 27  0 16 22 16  0 13 23  0  2  0  0 33 20  0 22\n[276]  6  8  5  6  0  0 14 21 20  1  0 22  2  0 54 27  1 10  0  0 10  0  0  0 12\n[301]  0  0  1  0 20 19  9 12  2 15  0  0  0  1  0  0  3  0  0  4  1  0  0\n\n#combine the two steps into one-line code\nmpsz$`PreSch Count` &lt;- lengths(st_intersects(mpsz, preschool))\n\n#alternatively, using tidyverse way\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Count`= lengths(st_intersects(mpsz,preschool)))\n\nNote: st_intersects() is a spatial predicate that quickly checks relationships between features and returns indices (or a list) showing which features intersect, without creating new geometries. In contrast, st_intersection() performs a full geometric overlay, generating new sf features that represent the actual overlapping geometries and carrying attributes from both input layers, which is more computationally intensive.\n\n# statistical summary for the new column\nsummary(mpsz$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n#top_n() of dplyr package to see the sub zone with the most number of pre-school\ntop_n(mpsz, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\nStep 2: The code chunk below uses st_area() from the sf package to calculate the area of each subzone, returning values in square metres because the CRS (SVY21) is in metres. Note that the SHAPE_Area field shown in the glimpse(mpsz) output is a precomputed attribute from the original dataset and may not be accurate for current analysis; we rely on st_area() instead.\n\nmpsz$AREA &lt;- mpsz %&gt;%\n  st_area()\n\nsummary(mpsz$AREA)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   39438   628261  1229894  2420882  2106483 69748299 \n\n\nThe code chunk below computes preschool density per km2 ( 1km2 = 1,000,000m2). We convert to per km2 to make the numbers comparable and readable.\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/AREA * 1000000)\n\n#quick overview of the stats for the new column\nsummary(mpsz$`PreSch Density`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nStep 3: EDA using ggplot2\n\nUse hist() of R Graphics to plot a histogram of the distribution of PreSch Density.\n\n\nhist(mpsz$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nuse ggplot2 functions to provide informative visualisation.\n\nb1. create a histogram\n\n#initiates the ggplot using mpsz data fram, set x-axis\nggplot(data=mpsz,\n       aes(x = as.numeric(`PreSch Density`))) +\n  #adds a histogram layer, with bin numbers, colour and fill colour\n  geom_histogram(bins = 20,\n                 color = \"black\",\n                 fill = \"lightblue\") + \n  #adds labels such as title, subtitle, and for x, y axis\n  labs(title = \"Are pre-school evenly distrubted in Singapore?\",\n      subtitle = \"There are many planning subzones with a single pre-school, on the other hand,\\nthere are seven planning subzones with at least 30 or more pre-schools.\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\n\n\n\nb2. create a scatterplot for PreSch Density and PreSch Count.\n\n#starts a ggplot with mpsz, and maps x to PreSch Density and y to PreSch Count.\n#Uses as.numeric() to drop units from PreSch Density and coerce it to plain numbers\nggplot(data=mpsz,\n       aes(y = `PreSch Count`,\n           x = as.numeric(`PreSch Density`))) +\n  #adds points and colours\n  geom_point(shape =21,\n             color =\"black\",\n             fill = \"lightblue\") +\n  #sets the range of data from 0 to 40.\n  xlim(0,40) +\n  ylim(0,40) + \n  #adds labels\n  labs(title =\"\",\n       x = \"Pre-school density (per km sq)\",\n       y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nThe End."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex01_1/Hands-on_Ex01_1.html#ex-1-geospatial-data-science-with-r",
    "href": "Hands-on_Ex/Hands-on_Ex01_1/Hands-on_Ex01_1.html#ex-1-geospatial-data-science-with-r",
    "title": "Hands-on Exercise 01-1",
    "section": "",
    "text": "The following code chunk uses the p_load() function from the pacman package to check whether the sf and tidyverse packages are installed. If they are, it loads them into the R session; if not, we could install them first via function install.packages() and then load them into R by using p_load().\n\npacman::p_load(sf,tidyverse)\n\n\n\n\nThe geospatial datasets include shapefiles and KML file. (The reason of selecting file format). The geospatial data consist of the Master Plan 2014 Subzone Boundary (Web), Pre-Schools Location from data.gov.sg, and Cycling Path from LTA DataMall. The aspatial dataset is the Singapore Airbnb listings from Inside Airbnb.\nR itself is case-sensitive, especially for object and function names. Whether file paths are case-sensitive depends on the operating system, e.g. On Windows: it is not case-sensitive.\n\n1.4.1 The code below uses the st_read() function from the sf package to load the Master Plan 2014 Subzone Boundary (Web) shapefile as a polygon data frame. For shapefiles, the .shp extension does not need to be specified in the code. Both absolute and relative paths can be used, but a relative path is applied here to keep the code cleaner and shorter.\n\n\nmpsz = st_read(dsn = \"data/geospatial\",\n               layer = \"mp14_SUBZONE_WEB_PL\")\n\nReading layer `mp14_SUBZONE_WEB_PL' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01_1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\n1.4.2 Similarly, the code below uses st_read() to import the Pre-Schools Location shapefile as a polyline data frame.\n\n\ncyclingpath = st_read(dsn = \"data/geospatial\",\n                      layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01_1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 4651 features and 19 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11721.1 ymin: 27550.13 xmax: 42809.37 ymax: 49702.59\nProjected CRS: SVY21\n\n\n\n1.4.3 The code below uses st_read() to import the Pre-Schools Location in KML format as point feature data frame into R. When importing a KML file, the .kml extension must be included.\n\nsvy21 vs wgs84?\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\lsrgc\\ISSS626-yiqiong-pan\\Hands-on_Ex\\Hands-on_Ex01_1\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\n\n\nBoth two code chunks display the basic information about the dataset. However, it is more common to use the second approach.\n\nmpsz$geom\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\nst_geometry(mpsz)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\nAlthough it is mentioned as one of the ways to retrieve the first 5 records like the two code chunks above, but here we see seems to be ID column?\n\nmpsz[[1]]\n\n  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18\n [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36\n [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54\n [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72\n [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90\n [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108\n[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126\n[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144\n[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162\n[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180\n[181] 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198\n[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216\n[217] 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234\n[235] 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252\n[253] 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270\n[271] 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288\n[289] 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306\n[307] 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323\n\n\nFurthermore, the code below uses glimpse() of dplyr to display more detailed attribute information in the data frame.\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\nLastly, the code below uses the head() function from base R (similar to Python, where the argument n can be set manually) to display the first few rows of the data frame for a quick overview.\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n\n\n\n\n\nVisualising an sf data frame is straightforward: using the plot() of Base R function automatically generates small coloured maps of the geometries by each attribute (field), while excluding non-informative columns such as the OBJECTID.\n\nplot(mpsz)\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\n\n\n\nMeanwhile, the code chunk below can be used to display the silhouette of the map:\n\nplot(st_geometry(mpsz))\n\n\n\n\n\n\n\n\nWe can also focus on a specific attribute by using the code chunk below:\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\n\n\nTo get a polished view of the data, we can use the tmap package, but it takes longer processing time:\n\n#library(tmap)\n#tm_shape(mpsz) +\n  #tm_fill(\"PLN_AREA_N\")+\n  #tm_borders()\n\n## comment out to save time\n\nBelow we quickly plot the preschool and cyclingpath.\n\nplot(st_geometry(preschool))\n\n\n\n\n\n\n\nplot(st_geometry(cyclingpath))\n\n\n\n\n\n\n\n\nBelow we can plot the cyclingpath layer on the top of the mpsz layer by using add argument.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(cyclingpath),\n     add = TRUE, col = \"Blue\")\n\n\n\n\n\n\n\n\nWhen trying the code with preschool, the preschool points does not appear on the subzone map because the two layers use different CRSs (mpsz in SVY21 and preschool in WGS84), transformation of preschool into the same CRS as mpsz is required before plotting the aligned map.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool),\n     add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\nst_crs(preschool)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"geodetic latitude (Lat)\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"geodetic longitude (Lon)\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\nst_crs(cyclingpath)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nThe above funtion st_crs() reveals that the layers of mpsz and cyclingpath are indeed in SVY21, but they are missing the correct EPSG code (3414). Assigning EPSG 3414 by using st_set_crs() of sf packages ensures the CRS is properly identified, as below:\n\nmpsz &lt;- st_set_crs(mpsz,3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nOn the other hand, the code below using st_transform() reprojects the preschool data from the WGS84 to SVY21.\n\npreschool &lt;- st_transform(preschool,\n                          crs = 3414)\n\nBy display the preview of preschool sf data, we can confirm its CRS is SVY21 now.\n\nst_geometry(preschool)\n\nGeometry set for 2290 features \nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\nFirst 5 geometries:\n\n\nPOINT Z (25089.46 31299.16 0)\n\n\nPOINT Z (27189.07 32792.54 0)\n\n\nPOINT Z (28844.56 36773.76 0)\n\n\nPOINT Z (24821.92 46303.16 0)\n\n\nPOINT Z (28637.82 35038.49 0)\n\n\nHere we could align both data together by setting add argument TRUE.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(preschool), add = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n1.8.1 The chunk below first uses read_csv() from readr to import listing.csv into R as a tibble data frame, and then applies list() from base R to preview the first 10 records, similar to glimpse() of dplyr.\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\n\nRows: 3659 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nlist(listings)\n\n[[1]]\n# A tibble: 3,659 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Ensuite …  367042 Belinda   East Region         Tampines          1.35\n 2  71896 B&B  Roo…  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Room 2-n…  367042 Belinda   East Region         Tampines          1.35\n 4 275343 10min wa… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 15 mins … 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 294281 5 mins w… 1521514 Elizabeth Central Region      Newton            1.31\n 7 324945 Comforta… 1439258 Kay       Central Region      Bukit Merah       1.29\n 8 330095 Relaxing… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 344803 Budget s…  367042 Belinda   East Region         Tampines          1.35\n10 369141 5mins fr… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,649 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n1.8.2 The code chunk below uses st_as_sf() of sf package to convert the listings data frame into a simple feature data frame. Specifically the coordinates are first defined in WGS84 (EPSG:4326, longitude/latitude in degrees) and then reprojected into Singapore’s SVY21 system (EPSG:3414, X/Y in metres).\n\nlistings_sf &lt;- st_as_sf(listings,\n                        coords = c(\"longitude\", \"latitude\"),\n                        crs = 4326) %&gt;% #used to nest st_transform() \n  st_transform(crs = 3414)\n\n\nglimpse(listings_sf)\n\nRows: 3,659\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 29…\n$ name                           &lt;chr&gt; \"Ensuite Room (Room 1 & 2) near EXPO\", …\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 143, NA, 76, NA, NA, 85, NA, NA, 41, 79…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 180, 180, 92, 180, 180, 92,…\n$ number_of_reviews              &lt;dbl&gt; 19, 24, 46, 20, 16, 131, 17, 5, 60, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.12, 0.14, 0.27, 0.13, 0.10, 0.80, 0.1…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 58, 58, 7, 58, 58, 5, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 90, 79, 90, 153, 153, 365, 153, 153, 36…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, \"S039…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…\n\n\nDIY: the code chuck below plots listings_sf onto mpsz layer. The map looks better when ploting mpsz first and then listings_sf, because the polygons give context (the “base map”), and the points can be layered on top without being hidden. Thus better order is polygons first, points later.\n\nplot(st_geometry(mpsz))\nplot(st_geometry(listings_sf), add = TRUE)\n\n\n\n\n\n\n\n\n\n#plot(st_geometry(listings_sf))\n#plot(st_geometry(mpsz), add = TRUE)\n\n\n\n\n\n\nTask: compute the total land area to reserve for a 5-m corridor/shoulder on both sides of the cycling paths.\n&lt;- assignment (always use this for storing values/importing data).\n= function arguments (inside function calls).\nSolution:\nStep 1: st_buffer() of sf package: 5-metre buffers of reserved land on both sides of existing cycling path.\n\n# quick review of the geometry type\nst_geometry_type(cyclingpath, by_geometry = FALSE)\n\n[1] MULTILINESTRING\n18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE\n\n\n\n# quick overview of the cycling path data\nglimpse(cyclingpath)\n\nRows: 4,651\nColumns: 20\n$ PATH_TYPE  &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ RD_CD      &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ LVL_NUM    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ AGENCY_IMP &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ AGENCY_MAI &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ GAZETTE_DA &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ LAUNCH_DAT &lt;date&gt; 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18, 2023-04-18…\n$ PATH_OWNER &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ MISC       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PKG_REF    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ SHAPE_LEN  &lt;dbl&gt; 18.732594, 94.469928, 9.169593, 51.320348, 29.886054, 38.38…\n$ RD_CD_DESC &lt;chr&gt; \"TAMPINES AVENUE 4\", \"PUNGGOL FIELD\", \"PUNGGOL FIELD\", \"PUN…\n$ PLANNING_1 &lt;chr&gt; \"TAMPINES\", \"PUNGGOL\", \"PUNGGOL\", \"PUNGGOL\", \"JURONG WEST\",…\n$ AGENCY_M_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ AGENCY_I_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ PATH_OWN_1 &lt;chr&gt; \"Land Transport Authority\", \"Land Transport Authority\", \"La…\n$ LVL_NUM_DE &lt;chr&gt; \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\", \"At-grade\",…\n$ PATH_TYPE_ &lt;chr&gt; \"Shared Path\", \"Shared Path\", \"Shared Path\", \"Shared Path\",…\n$ geometry   &lt;MULTILINESTRING [m]&gt; MULTILINESTRING ((40128.23 ..., MULTILINEST…\n\n\n\nbuffer_cycling &lt;- st_buffer(\n  cyclingpath, dist=5, nQuadSegs = 30)\n\n#st_buffer()builds polygons at a fixed offset from a geometry.\n#cyclingpath is input, multilinestrings layer\n#dist=5, buffer distance in the layer's units. \n#Here CRS is SVY221 in metre, thus no transformation is required.\n#nQuadSegs = 30, higher the value, smoother the curve in the buffer around corners or ends.\n#stands for “number of line segments to use to approximate a quarter circle\".\n\nStep 2: use st_area() to calculate each area of the buffers\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n#st_area() returns area of each feature in the geometry column\n# units vector (m^2)\n#buffer_cycling$AREA adds a new attribute column AREA\n\nAlternatively, code uses tidyverse\n\nbuffer_cycling &lt;- buffer_cycling %&gt;%\n  mutate(AREA = st_area(geometry))\n# mutate() of dplyr, just like the $AREA, creates a new column AREA\n#geometry is the sf geometry column; st_area(geometry) computes area for each row.\n\nStep 3: sum() of Base R to add up all AREA values.\nWhat if the areas are overlapped?\n\nsum(buffer_cycling$AREA)\n\n3561648 [m^2]\n\n\nStep 4: plotting the buffer by a selected planning subzone: Tampines West\n\nfilter() of dplyr package to select the subzone\n\n\n#quick overview of the mpsz\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\nmpsz_selected &lt;- mpsz %&gt;%\n  filter(SUBZONE_N == \"TAMPINES WEST\")\n#quick overview of the newly selected subzone\nst_geometry(mpsz_selected)\n\nGeometry set for 1 feature \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 38199.84 ymin: 35355.22 xmax: 40642.12 ymax: 38054.52\nProjected CRS: SVY21 / Singapore TM\n\n\nMULTIPOLYGON (((39918.43 35362.32, 39909.84 353...\n\n#creating a plot for the subzone in general\nplot(st_geometry(mpsz_selected))\n\n\n\n\n\n\n\n\n\nst_intersection() of sf package to clip clycing buffers within the subzone. Both layers are in the SVY21. However, since EPSG code is missing in buffer_cycling, we need to assign the code 3414 to it before performing intersection.\n\n\n# checking features of the two layers\nst_crs(buffer_cycling)$epsg\n\n[1] NA\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\nst_crs(mpsz_selected)$epsg\n\n[1] 3414\n\nst_crs(buffer_cycling)$Name\n\n[1] \"SVY21\"\n\n# EPSG assignment, or use 3414 as second parameter\nbuffer_cycling &lt;- st_set_crs(buffer_cycling, st_crs(mpsz_selected))\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\n\n\nbuffer_cycling_selected &lt;- st_intersection(\n  buffer_cycling, mpsz_selected)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n#st_intersection(x, y) returns a new sf object = overlapping parts of x and y\n\n\nplot() to create the plot\n\n\nplot(st_geometry(buffer_cycling_selected))\n\n\n\n\n\n\n\n\nDONE!\n\n\n\nSolution:\nStep 1: Use st_intersects() from the sf package to identify pre-schools located inside each subzone. Then, use the length() function from base R to calculate the number of pre-school points within each subzone. The function st_intersects() returns a list of intersections. While length() returns only the total number of subzones, the lengths() function works on a list and returns a vector with the length of each element.\n\n#perform an overview of both data frames first\nglimpse(preschool)\n\nRows: 2,290\nColumns: 3\n$ Name        &lt;chr&gt; \"kml_1\", \"kml_2\", \"kml_3\", \"kml_4\", \"kml_5\", \"kml_6\", \"kml…\n$ Description &lt;chr&gt; \"&lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Att…\n$ geometry    &lt;POINT [m]&gt; POINT Z (25089.46 31299.16 0), POINT Z (27189.07 327…\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n#show the outputs individually\nst_intersects(mpsz, preschool)\n\nSparse geometry binary predicate list of length 323, where the\npredicate was `intersects'\nfirst 10 elements:\n 1: (empty)\n 2: 764, 1258, 1503, 1562, 1670, 2035\n 3: (empty)\n 4: 151, 748, 1140, 1844, 2209\n 5: 190, 1496, 1924\n 6: 237, 238, 260, 264, 283, 292, 391, 714, 949, 1494, ...\n 7: 766, 1088, 1254, 1867, 2021\n 8: 498\n 9: 363, 399, 642, 1696, 1734, 1757, 1915, 1941, 2142, 2232, ...\n 10: 1470\n\nlength(st_intersects(mpsz, preschool))\n\n[1] 323\n\nlengths(st_intersects(mpsz, preschool))\n\n  [1]  0  6  0  5  3 13  5  1 11  1  4  2  0  1  6  0  0  0  0  4  0  1  0  5  4\n [26]  1  7  2 12  7  0  0  4  0  4 10  1  3  0  6  0  3  1  0  3  0  4  1  9  0\n [51]  1  4  1  2  4  0  2  1  2  0  3  0  2  6  1  0 13  3 14  1  4  9  1  5  0\n [76]  0  3 11  0  0  1  0  3  1  2  0  0  5  0  7  3  4  0  0  7  0  0  2  0  4\n[101] 10  0 14  0  3  2  2 29 18 21  0  0  5  5  0 10 23 22  7  2  1  0  0  0  6\n[126]  6  3  0  0  8  5  5  8  6  5  5 11  9  8  0  3  8  1  0  3 24  0  7 18 11\n[151] 10 28 13  4  0  6  6  0  2  8  6  0 40  4 21  0 36 14  4 16 11 13  5  7  9\n[176] 12 30  0  0 11 13 38 11  0  8 19  5  5 72  9  0  4 32  7  3  3  9  3 38 18\n[201]  0 15  0 12  4 11 23 16  0  7 21 19  8 20 15 26  6 23 13  6  0 13  5 12 10\n[226]  7  6  7  1  8 25  3  8  0  0 18 13 10 16  9  9 17  5  1  3 22  4 12  4  9\n[251]  3  0 17 10  4  0  0  9 16 27  0 16 22 16  0 13 23  0  2  0  0 33 20  0 22\n[276]  6  8  5  6  0  0 14 21 20  1  0 22  2  0 54 27  1 10  0  0 10  0  0  0 12\n[301]  0  0  1  0 20 19  9 12  2 15  0  0  0  1  0  0  3  0  0  4  1  0  0\n\n#combine the two steps into one-line code\nmpsz$`PreSch Count` &lt;- lengths(st_intersects(mpsz, preschool))\n\n#alternatively, using tidyverse way\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Count`= lengths(st_intersects(mpsz,preschool)))\n\nNote: st_intersects() is a spatial predicate that quickly checks relationships between features and returns indices (or a list) showing which features intersect, without creating new geometries. In contrast, st_intersection() performs a full geometric overlay, generating new sf features that represent the actual overlapping geometries and carrying attributes from both input layers, which is more computationally intensive.\n\n# statistical summary for the new column\nsummary(mpsz$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n#top_n() of dplyr package to see the sub zone with the most number of pre-school\ntop_n(mpsz, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\nStep 2: The code chunk below uses st_area() from the sf package to calculate the area of each subzone, returning values in square metres because the CRS (SVY21) is in metres. Note that the SHAPE_Area field shown in the glimpse(mpsz) output is a precomputed attribute from the original dataset and may not be accurate for current analysis; we rely on st_area() instead.\n\nmpsz$AREA &lt;- mpsz %&gt;%\n  st_area()\n\nsummary(mpsz$AREA)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n   39438   628261  1229894  2420882  2106483 69748299 \n\n\nThe code chunk below computes preschool density per km2 ( 1km2 = 1,000,000m2). We convert to per km2 to make the numbers comparable and readable.\n\nmpsz &lt;- mpsz %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/AREA * 1000000)\n\n#quick overview of the stats for the new column\nsummary(mpsz$`PreSch Density`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   5.154   6.449  10.908  35.602 \n\n\nStep 3: EDA using ggplot2\n\nUse hist() of R Graphics to plot a histogram of the distribution of PreSch Density.\n\n\nhist(mpsz$`PreSch Density`)\n\n\n\n\n\n\n\n\n\nuse ggplot2 functions to provide informative visualisation.\n\nb1. create a histogram\n\n#initiates the ggplot using mpsz data fram, set x-axis\nggplot(data=mpsz,\n       aes(x = as.numeric(`PreSch Density`))) +\n  #adds a histogram layer, with bin numbers, colour and fill colour\n  geom_histogram(bins = 20,\n                 color = \"black\",\n                 fill = \"lightblue\") + \n  #adds labels such as title, subtitle, and for x, y axis\n  labs(title = \"Are pre-school evenly distrubted in Singapore?\",\n      subtitle = \"There are many planning subzones with a single pre-school, on the other hand,\\nthere are seven planning subzones with at least 30 or more pre-schools.\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\n\n\n\nb2. create a scatterplot for PreSch Density and PreSch Count.\n\n#starts a ggplot with mpsz, and maps x to PreSch Density and y to PreSch Count.\n#Uses as.numeric() to drop units from PreSch Density and coerce it to plain numbers\nggplot(data=mpsz,\n       aes(y = `PreSch Count`,\n           x = as.numeric(`PreSch Density`))) +\n  #adds points and colours\n  geom_point(shape =21,\n             color =\"black\",\n             fill = \"lightblue\") +\n  #sets the range of data from 0 to 40.\n  xlim(0,40) +\n  ylim(0,40) + \n  #adds labels\n  labs(title =\"\",\n       x = \"Pre-school density (per km sq)\",\n       y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\nThe End."
  }
]